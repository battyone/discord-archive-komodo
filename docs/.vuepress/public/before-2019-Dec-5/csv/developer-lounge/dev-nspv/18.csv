AuthorID;Author;Date;Content;Attachments;Reactions;
"455741312273219595";"jl777c#5810";"10-Jul-19 10:54 AM";"it should work, just get non-zero retcodes";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:56 AM";"./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 12
{
  ""txid"": ""a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439"",
  ""overwintered"": true,
  ""version"": 4,
  ""versiongroupid"": ""892f2085"",
  ""locktime"": 1562755312,
  ""expiryheight"": 0,
  ""vin"": [
    {
      ""txid"": ""39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a"",
      ""vout"": 0,
      ""scriptSig"": {
        ""asm"": """",
        ""hex"": """"
      },
      ""sequence"": 4294967295
    }
  ],
  ""vout"": [
    {
      ""value"": 12.00000000,
      ""valueZat"": 1200000000,
      ""n"": 0,
      ""scriptPubKey"": {
        ""asm"": ""OP_DUP OP_HASH160 28fa8a1d009b41c1b8bb7671b1147d211c4885a5 OP_EQUALVERIFY OP_CHECKSIG"",
        ""hex"": ""76a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac"",
        ""reqSigs"": 1,
        ""type"": ""pubkeyhash"",
        ""addresses"": [
          ""RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8""
        ]
      }
    },
    {
      ""value"": 5.21996846,
      ""valueZat"": 521996846,
      ""n"": 1,
      ""scriptPubKey"": {
        ""asm"": ""02bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936e OP_CHECKSIG"",
        ""hex"": ""2102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eac"",
        ""reqSigs"": 1,
        ""type"": ""pubkey"",
        ""addresses"": [
          ""RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8""
        ]
      }
    }
  ],
  ""vjoinsplit"": [
  ],
  ""valueBalance"": 0.00000000,
  ""vShieldedSpend"": [
  ],
  ""vShieldedOutput"": [
  ],
  ""result"": ""success"",
  ""hex"": ""0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390000000000ffffffff02008c8647000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac2e0a1d1f00000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eacf0c0255d000000000000000000000000000000"",
  ""retcodes"": [
    -1
  ]";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:56 AM";"./komodo-cli nspv_broadcast 0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390000000000ffffffff02008c8647000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac2e0a1d1f00000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eacf0c0255d000000000000000000000000000000
{
  ""result"": ""success"",
  ""expected"": ""a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439"",
  ""broadcast"": ""a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439"",
  ""retcode"": 0,
  ""type"": ""broadcast""";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 10:56 AM";"still no signatures";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:57 AM";"Yeah";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:57 AM";"RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 numutxos.3 balance 19.96960000
got txproof response 1562756090 size.1967 39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a ht.1436524
got ntzs response 1562756091 size.209 54fd1d42fb20a161a48af5505d3109483da4c28fdf6b369067ffb535521f59a6 prev.1436510, e5fa323ef34eea3d0fbeac2f9a7d14714eab88c5b3c96516d8818f12acfdcfb3 next.1436530
gettx ht.1436524 prev.1436510 next.1436530
couldnt find txid.39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a/v0 or it was spent
sign 1 inputs 17.22000000 + interest 0.00006846 -> 2 outputs 12.00000000 change 5.21996846
got ntzproof response 1562756098 size.34524 prev.1436510 next.1436530
got broadcast response 1562756112 size.37 a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439 retcode.0";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 10:57 AM";"are you sure you updated?";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:57 AM";"Getting the same error as before, utxo was spent";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:57 AM";"Yeah and rebuilt";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:57 AM";"im on jl777 branch";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:58 AM";"git pull
remote: Enumerating objects: 8, done.
remote: Counting objects: 100% (8/8), done.
remote: Compressing objects: 100% (8/8), done.
remote: Total 8 (delta 2), reused 2 (delta 0), pack-reused 0
Unpacking objects: 100% (8/8), done.
From https://github.com/jl777/komodo
   bc60137..52eec3e  FSM        -> origin/FSM
   1089c25..ce62d15  nSPV       -> origin/nSPV
Already up-to-date.";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 10:58 AM";"try nSPV branch, that works for me";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 10:59 AM";"changed branches and rebuilding";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:07 AM";"much better now 😃";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:07 AM";"Even gives the full node IP 😃";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 11:08 AM";"you were able to spend?";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:08 AM";"yes on the new branch";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:08 AM";"https://kmd.explorer.dexstats.info/tx/88f14f91b6b2a2c0b312554e0a5ee39218bcab3124daf75876c3db987dd82b21";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 11:09 AM";"ok good. i will propagate it to jl777/FSM and then go into deep coding on nSPV";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 11:11 AM";"did it show ""rewards"" and ""validated""?";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:11 AM";"I tried something silly, sent a tx using the biggest UTXO, before it was confirmed i did another TX that would have had to use that new UTXO, got retcode of 0";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:12 AM";"./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 15
{
  ""rewards"": 8.802e-05,
  ""validated"": 8.802e-05,
  ""txid"": ""88f14f91b6b2a2c0b312554e0a5ee39218bcab3124daf75876c3db987dd82b21"",
  ""overwintered"": true,
  ""version"": 4,
  ""versiongroupid"": ""892f2085"",
  ""locktime"": 1562755999,
  ""expiryheight"": 0,";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:12 AM";"This was the working one";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:13 AM";"This is the non working one

./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 14
{
  ""rewards"": 9.127999999999999e-05,
  ""validated"": 0,
  ""txid"": ""57a64d2ff9d4cadfd1fe66a1d83e72d7ae5e46923c4fd091b47515138ea21193"",
  ""overwintered"": true,
  ""version"": 4,
  ""versiongroupid"": ""892f2085"",
  ""locktime"": 1562756105,
  ""expiryheight"": 0,";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 11:15 AM";"ok, all branches in sync. superlite client has no idea about mempool, unconfirmed tx, etc.";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 11:16 AM";"be nice to it and it will be nice to you";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:17 AM";":troll_thuglife:";"";"";
"459844460625526824";"hyperDEX#6586";"10-Jul-19 11:19 AM";"https://kmd.explorer.dexstats.info/tx/7199bc0a605b0ba203d8038ef5b4860b446e5b1f9c0e2a449a93075b9bd72ca2 I caressed it and got a happy ending";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:07 PM";"@TonyL @SHossain before diving into multithreading (which would also force going to an opid sort of two step rpc process), i experimented with a simple caching. and it works pretty well. it is a hardforking update";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:08 PM";"the change is to issue the nspv_spend as long as the retcodes are changing or come back all 0";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:09 PM";"this uses the first nspv_spend to get most of what is needed into the cache. I have a few ideas for how to speed up addresses with small number of utxo and at that point it is still single threaded but fast enough for normal usage";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:12 PM";"First spend supposed to have same speed as before and next one faster?";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:21 PM";"yes";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:33 PM";"first nspv_spend `real    0m2.421s`, got retocde ```  ""retcodes"": [
    -2
  ]```

then without broadcast called again `real    0m2.819s`  ```  ""retcodes"": [
    0
  ]
```";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:37 PM";"next calls 1.7, 2.0, 2.8, 1.7 and so on";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:37 PM";"good and the big improvement is that it is retcode of 0, meaning fully validated, especially if you see the notarization bitmasks";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:45 PM";"and txs broadcasting fine on my side";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:48 PM";"yes, many bugs fixed today too. i think latest jl777/FSM is pretty stable";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:49 PM";"added to wallet all calls/responses printing to console, now will fix some stuff reported above";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:52 PM";"getting such retcode now and rapid responses ``` ""retcodes"": [
    -2004
  ]
}

real    0m0.003s
```";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 02:55 PM";"fresh not-notarized yet input used
broadcasted fine:
```{
  ""result"": ""success"",
  ""expected"": ""2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258"",
  ""broadcast"": ""2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258"",
  ""retcode"": 1,
  ""type"": ""broadcast and mempool"",
  ""lastpeer"": ""23.254.165.16:7770""
}
```";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 02:59 PM";"-2004 means not notarized";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:02 PM";"wallet working much faster with latest komodod";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:03 PM";"tx broadcasting part";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:03 PM";"you can speed up the spend even more by doing the following on login:
nspv_listunspent
for each utxo, nspv_txproof";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:03 PM";"that will load into the cache your utxos and all the tx data";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:03 PM";"still some calls are needed, but only a few";"";"🔥 (1)";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:03 PM";"aha, I'm doing nspv_listunspent on login and on each refresh button click (to fetch balance)";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:04 PM";"can add nspv_txproof call for each utxo on login";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:11 PM";"best to do it in the background if you are setup for that";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:12 PM";"threading time 😃";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:13 PM";"maybe just do it if there are less than 3 utxo";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:13 PM";"then it doesnt have to be threaded. it seems fast enough as it is";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:20 PM";"it was pretty fast for 9 utxos in my wallet - set 10 utxos limit for nspv_txproof for now";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:21 PM";"and then daemon saying that loading it from cache:
```FROM CACHE NSPV_txproof 9ab09345d428d90a0a8a72cd9e5169911fb77ce3acf8d3cdebb0163d82ec6505
{'height': 1436848, 'txid': '978b05a942550f9fb9693cc488cb482bc442b9cc88e4779c726afa7439f70c1c', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 978b05a942550f9fb9693cc488cb482bc442b9cc88e4779c726afa7439f70c1c
{'height': 1436858, 'txid': '2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258
{'height': 1436874, 'txid': '1b0e2de9c5156ca619937e9657af687dc00e42800166a15131afcc2dfefe4bab', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 1b0e2de9c5156ca619937e9657af687dc00e42800166a15131afcc2dfefe4bab
{'height': 1433334, 'txid': '3abed08f0d2a9dbb46c5da89518789805620e70a5d6770c0fd3e1042ff7c0ab8', 'vout': 1, 'value': 0.26016152, 'interest': 0}
FROM CACHE NSPV_txproof 3abed08f0d2a9dbb46c5da89518789805620e70a5d6770c0fd3e1042ff7c0ab8
```";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:21 PM";"so seems to work as expected";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:22 PM";"have to add txfees and rewards to confrimation popup - just noticed that there is new rewards field in spend output";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:23 PM";"yes, it shows the rewards that came in from the fullnode and a validated, which is what the local node calculates";"";"";
"455741312273219595";"jl777c#5810";"10-Jul-19 03:23 PM";"avoids the attack of fullnode returning 0 interest and having the reward going to miner";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:28 PM";"rewards displaying added";"";"";
"272003866906722306";"TonyL#3577";"10-Jul-19 03:35 PM";"`when you already have a wif in the login box and you double click the wif then paste a new wif, it does not replace what is there, it adds the pasted item to the end of the existing text in the box` pushed fix for it also (for all fields)";"";"rum (2)";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:16 PM";"https://paste.ubuntu.com/p/5hZXrK7MGZ/ nspv_spend takes more than 20 seconds atm on my side (for whole balance) and getting a lot of prints";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:17 PM";"10 inputs combined takes a lot of time to prepare tx";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:17 PM";"2 seconds per vin";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:17 PM";"yes";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:17 PM";"still a little faster than syncing a fullnode";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:18 PM";"so it's better to not import to my wallet something like a NN operator privkey 😃";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:18 PM";"yes, likely it will break things";"";"";
"459844460625526824";"hyperDEX#6586";"11-Jul-19 12:18 PM";"lol";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:18 PM";"64 utxo is max";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 12:18 PM";"no guards against such things yet";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:20 PM";"i sent yesterday 30 utxos. and worked fine including claiming accrued rewards";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:20 PM";"then, i sent to external address";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:24 PM";"and, a lot of prints for those 30 utxos";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:24 PM";"for 30 utxos should prepare tx for a like a minute 😃";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:24 PM";"yes it was";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:24 PM";"let me check how many utxos i have now and will time  it";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:26 PM";"i have 11 utxos";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:28 PM";"will take 30 seconds is my prediction";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:29 PM";"you are right";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:30 PM";"```
  ""retcodes"": [
    -2,
    -2,
    -2002,
    0,
    -2002,
    0,
    0,
    0,
    0,
    -2
  ]
}

real    0m26.305s
user    0m0.001s
sys    0m0.006s
```";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:31 PM";"2nd run
```
  ""retcodes"": [
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0
  ]
}

real    0m23.018s
user    0m0.004s
sys    0m0.000s
```";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:33 PM";"caching raised speed on 11%";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 12:33 PM";"🏎";"";"";
"412323938782150658";"SHossain#0007";"11-Jul-19 12:36 PM";"and, all utxos validated";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 01:02 PM";"pushed patch to wallet which allows operations with big utxos amount (before underlaying RPC lib got connection timeout almost everytime in such long calls)";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 01:03 PM";"```'rewards': 44980600000000, 'validated': 44980600000000``` are rewards in nspv_getinfo supposed to be displayed in satoshis? if yes - too many digits there";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 01:04 PM";"`0.00449806` my actual rewards";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 03:59 PM";"pushed fix to jl777 branch";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 04:05 PM";"@TonyL caching is actually speeding it up 10x";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 04:06 PM";"each iteration it does more and more work as more data becomes available";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 04:11 PM";"hmm never notice such massive speedup on next calls after retcodes became 0, usually it's 1-2 seconds difference";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 04:12 PM";"it is doing notarization validation when retcode 0";"";"";
"455741312273219595";"jl777c#5810";"11-Jul-19 04:12 PM";"if other retcode, it usually skips all that";"";"";
"272003866906722306";"TonyL#3577";"11-Jul-19 04:22 PM";"rewards indication is fixed on latest jl777 `""rewards"": ""0.00522367""`";"";"";
"455741312273219595";"jl777c#5810";"13-Jul-19 09:35 AM";"i made a hardforking update. please update all nodes. in the channel purpose at top of screen are the ways to start the NSPV chain . it has low diff so you can mine a few blocks to get coins, or just use faucetget. I also set up 10 KMD nSPV fullnodes, so it has a theoretical capacity of 8000 nodes saturating it, or likely 100,000+ normal usage nodes.
main improvements are bugfixes, 99% chance to get final rpc result on the first call, and initial CC support. so far faucet is working, along with a few of tokens calls, but havent been able to test a lot yet. each CC rpc is able to use any info in the daemon, and if it uses any but the most standard, it will need to be updated. no idea what percentage of calls this is. shossain has started testing and results from yesterdays version is https://docs.google.com/spreadsheets/d/1c4FHg33phx2u3ko8Pg8SamA7jBllwzY-_QCCF91PX4k/edit#gid=1636254260";"";"🔥 (1),🚀 (1)";
"455741312273219595";"jl777c#5810";"13-Jul-19 09:35 AM";"there is also the ILN chain if you want to test notarization validation";"";"";
"455741312273219595";"jl777c#5810";"13-Jul-19 09:54 AM";"nodes are 5.9.102.210, 5.9.253.195 to 5.9.253.203 you can addnode to all of those to get the most fullnodes and highest throughput";"";"";
"455741312273219595";"jl777c#5810";"13-Jul-19 01:41 PM";"latest version supports nspv_listtransactions";"";"";
"412323938782150658";"SHossain#0007";"13-Jul-19 01:42 PM";"did anyone notice yet that CC works with nSPV? 😉";"";"😃 (1)";
