<!DOCTYPE html>
<html lang="en">

<head>
    <title>Komodo - cc-general</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />

    <style>
        /* === GENERAL === */

@font-face {
    font-family: Whitney;
    src: url(https://discordapp.com/assets/6c6374bad0b0b6d204d8d6dc4a18d820.woff);
    font-weight: 300;
}

@font-face {
    font-family: Whitney;
    src: url(https://discordapp.com/assets/e8acd7d9bf6207f99350ca9f9e23b168.woff);
    font-weight: 400;
}

@font-face {
    font-family: Whitney;
    src: url(https://discordapp.com/assets/3bdef1251a424500c1b3a78dea9b7e57.woff);
    font-weight: 500;
}

@font-face {
    font-family: Whitney;
    src: url(https://discordapp.com/assets/be0060dafb7a0e31d2a1ca17c0708636.woff);
    font-weight: 600;
}

@font-face {
    font-family: Whitney;
    src: url(https://discordapp.com/assets/8e12fb4f14d9c4592eb8ec9f22337b04.woff);
    font-weight: 700;
}

body {
    font-family: "Whitney", "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 17px;
}

a {
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

img {
    object-fit: contain;
}

.markdown {
    white-space: pre-wrap;
    line-height: 1.3;
    overflow-wrap: break-word;
}

.spoiler {
    border-radius: 3px;
}

.quote {
    border-left: 4px solid;
    border-radius: 3px;
    margin: 8px 0;
    padding-left: 10px;
}

.pre {
    font-family: "Consolas", "Courier New", Courier, monospace;
}

.pre--multiline {
    margin-top: 4px;
    padding: 8px;
    border: 2px solid;
    border-radius: 5px;
}

.pre--inline {
    padding: 2px;
    border-radius: 3px;
    font-size: 85%;
}

.mention {
    font-weight: 500;
}

.emoji {
    width: 1.45em;
    height: 1.45em;
    margin: 0 1px;
    vertical-align: -0.4em;
}

.emoji--small {
    width: 1rem;
    height: 1rem;
}

.emoji--large {
    width: 2rem;
    height: 2rem;
}

/* === INFO === */

.info {
    display: flex;
    max-width: 100%;
    margin: 0 5px 10px 5px;
}

.info__guild-icon-container {
    flex: 0;
}

.info__guild-icon {
    max-width: 88px;
    max-height: 88px;
}

.info__metadata {
    flex: 1;
    margin-left: 10px;
}

.info__guild-name {
    font-size: 1.4em;
}

.info__channel-name {
    font-size: 1.2em;
}

.info__channel-topic {
    margin-top: 2px;
}

.info__channel-message-count {
    margin-top: 2px;
}

.info__channel-date-range {
    margin-top: 2px;
}

/* === CHATLOG === */

.chatlog {
    max-width: 100%;
    margin-bottom: 24px;
}

.chatlog__message-group {
    display: flex;
    margin: 0 10px;
    padding: 15px 0;
    border-top: 1px solid;
}

.chatlog__author-avatar-container {
    flex: 0;
    width: 40px;
    height: 40px;
}

.chatlog__author-avatar {
    border-radius: 50%;
    height: 40px;
    width: 40px;
}

.chatlog__messages {
    flex: 1;
    min-width: 50%;
    margin-left: 20px;
}

.chatlog__author-name {
    font-size: 1em;
    font-weight: 500;
}

.chatlog__timestamp {
    margin-left: 5px;
    font-size: .75em;
}

.chatlog__message {
    padding: 2px 5px;
    margin-right: -5px;
    margin-left: -5px;
    background-color: transparent;
    transition: background-color 1s ease;
}

.chatlog__content {
    font-size: .9375em;
    word-wrap: break-word;
}

.chatlog__edited-timestamp {
    margin-left: 3px;
    font-size: .8em;
}

.chatlog__attachment-thumbnail {
    margin-top: 5px;
    max-width: 50%;
    max-height: 500px;
    border-radius: 3px;
}

.chatlog__embed {
    margin-top: 5px;
    display: flex;
    max-width: 520px;
}

.chatlog__embed-color-pill {
    flex-shrink: 0;
    width: 4px;
    border-top-left-radius: 3px;
    border-bottom-left-radius: 3px;
}

.chatlog__embed-content-container {
    display: flex;
    flex-direction: column;
    padding: 8px 10px;
    border: 1px solid;
    border-top-right-radius: 3px;
    border-bottom-right-radius: 3px;
}

.chatlog__embed-content {
    width: 100%;
    display: flex;
}

.chatlog__embed-text {
    flex: 1;
}

.chatlog__embed-author {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
}

.chatlog__embed-author-icon {
    width: 20px;
    height: 20px;
    margin-right: 9px;
    border-radius: 50%;
}

.chatlog__embed-author-name {
    font-size: .875em;
    font-weight: 600;
}

.chatlog__embed-title {
    margin-bottom: 4px;
    font-size: .875em;
    font-weight: 600;
}

.chatlog__embed-description {
    font-weight: 500;
    font-size: 14px;
}

.chatlog__embed-fields {
    display: flex;
    flex-wrap: wrap;
}

.chatlog__embed-field {
    flex: 0;
    min-width: 100%;
    max-width: 506px;
    padding-top: 10px;
}

.chatlog__embed-field--inline {
    flex: 1;
    flex-basis: auto;
    min-width: 150px;
}

.chatlog__embed-field-name {
    margin-bottom: 4px;
    font-size: .875em;
    font-weight: 600;
}

.chatlog__embed-field-value {
    font-size: .875em;
    font-weight: 500;
}

.chatlog__embed-thumbnail {
    flex: 0;
    margin-left: 20px;
    max-width: 80px;
    max-height: 80px;
    border-radius: 3px;
}

.chatlog__embed-image-container {
    margin-top: 10px;
}

.chatlog__embed-image {
    max-width: 500px;
    max-height: 400px;
    border-radius: 3px;
}

.chatlog__embed-footer {
    margin-top: 10px;
}

.chatlog__embed-footer-icon {
    margin-right: 4px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    vertical-align: middle;
}

.chatlog__embed-footer-text {
    font-weight: 500;
    font-size: .75em;
}

.chatlog__reactions {
    display: flex;
}

.chatlog__reaction {
    display: flex;
    align-items: center;
    margin: 6px 2px 2px 2px;
    padding: 3px 6px;
    border-radius: 3px;
}

.chatlog__reaction-count {
    min-width: 9px;
    margin-left: 6px;
    font-size: .875em;
}

.chatlog__bot-tag {
    margin-left: 0.3em;
    background: #7289da;
    color: #ffffff;
    font-size: 0.625em;
    padding: 1px 2px;
    border-radius: 3px;
    vertical-align: middle;
    line-height: 1.3;
    position: relative;
    top: -.2em;
}
    </style>
    <style>
        /* === GENERAL === */

body {
    background-color: #36393e;
    color: #dcddde;
}

a {
    color: #0096cf;
}

.spoiler {
    background-color: rgba(255, 255, 255, 0.1);
}

.quote {
    border-color: #4f545c;
}

.pre {
    background-color: #2f3136 !important;
}

.pre--multiline {
    border-color: #282b30 !important;
    color: #839496 !important;
}

.mention {
    color: #7289da;
}

/* === INFO === */

.info__guild-name {
    color: #ffffff;
}

.info__channel-name {
    color: #ffffff;
}

.info__channel-topic {
    color: #ffffff;
}

/* === CHATLOG === */

.chatlog__message-group {
    border-color: rgba(255, 255, 255, 0.1);
}

.chatlog__author-name {
    color: #ffffff;
}

.chatlog__timestamp {
    color: rgba(255, 255, 255, 0.2);
}

.chatlog__message--highlighted {
    background-color: rgba(114, 137, 218, 0.2) !important;
}

.chatlog__message--pinned {
    background-color: rgba(249, 168, 37, 0.05);
}

.chatlog__edited-timestamp {
    color: rgba(255, 255, 255, 0.2);
}

.chatlog__embed-content-container {
    background-color: rgba(46, 48, 54, 0.3);
    border-color: rgba(46, 48, 54, 0.6);
}

.chatlog__embed-author-name {
    color: #ffffff;
}

.chatlog__embed-author-name-link {
    color: #ffffff;
}

.chatlog__embed-title {
    color: #ffffff;
}

.chatlog__embed-description {
    color: rgba(255, 255, 255, 0.6);
}

.chatlog__embed-field-name {
    color: #ffffff;
}

.chatlog__embed-field-value {
    color: rgba(255, 255, 255, 0.6);
}

.chatlog__embed-footer {
    color: rgba(255, 255, 255, 0.6);
}

.chatlog__reaction {
    background-color: rgba(255, 255, 255, 0.05);
}

.chatlog__reaction-count {
    color: rgba(255, 255, 255, 0.3);
}
    </style>

    <script>
        function scrollToMessage(event, id) {
            var element = document.getElementById('message-' + id);

            if (element !== null && element !== undefined) {
                event.preventDefault();

                element.classList.add('chatlog__message--highlighted');

                window.scrollTo({
                    top: element.getBoundingClientRect().top - document.body.getBoundingClientRect().top - (window.innerHeight / 2),
                    behavior: 'smooth'
                });

                window.setTimeout(function() {
                    element.classList.remove('chatlog__message--highlighted');
                }, 2000);
            }
        }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.pre--multiline').forEach((block) => {
                hljs.highlightBlock(block);
            });
        });
    </script>
</head>
<body>

<div class="info">
    <div class="info__guild-icon-container">
        <img class="info__guild-icon" src="https://cdn.discordapp.com/icons/412898016371015680/a_157cb08c4198ad53b9e9b7168c930571.png" />
    </div>
    <div class="info__metadata">
        <div class="info__guild-name">Komodo</div>
        <div class="info__channel-name">cc-general</div>

            <div class="info__channel-topic">Dev Docs: https://developers.komodoplatform.com | Test plan: https://docs.google.com/spreadsheets/d/1l0dWEPcrv9zE11_TD-XrX_HIYV0VLpadCJN6hvaZERc/edit#gid=211514340
https://medium.com/@jameslee777/how-to-implement-finite-state-machines-into-a-cc-8dfeadccbcad
https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC</div>

        <div class="info__channel-message-count">100 messages</div>

            <div class="info__channel-date-range">
                    Before 05-Dec-19 12:00 AM
            </div>
    </div>
</div>

<div class="chatlog">
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/3.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="polycryptoblog#1173" data-user-id="406179072922746882">polycryptoblog</span>


                <span class="chatlog__timestamp">26-Oct-19 05:13 AM</span>

                    <div class="chatlog__message " data-message-id="637519237161680916" id="message-637519237161680916">
                        <div class="chatlog__content">
                            <span class="markdown">This is exactly what is needed for certain interested parties.   I think this is the biggest thing to come out of the Komodo ecosystem so far.   This will allow for complex blockchains and clusters which currently don’t exist yet.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="637519288739299338" id="message-637519288739299338">
                        <div class="chatlog__content">
                            <span class="markdown"></span>

                        </div>

                        <div class="chatlog__attachment">
                            <a href="https://cdn.discordapp.com/attachments/466507187842187264/637519287753375744/image0.gif">
                                
                                    <img class="chatlog__attachment-thumbnail" src="https://cdn.discordapp.com/attachments/466507187842187264/637519287753375744/image0.gif" />
                            </a>
                        </div>


                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">26-Oct-19 05:33 AM</span>

                    <div class="chatlog__message " data-message-id="637524210562105366" id="message-637524210562105366">
                        <div class="chatlog__content">
                            <span class="markdown">yes FSM was scheduled as the last major CC as it needs to be able to utilize all the other core CC and with FSM CC, new logic can be deployed via rpc calls, no need for a hardfork</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">26-Oct-19 07:43 AM</span>

                    <div class="chatlog__message " data-message-id="637556791210803212" id="message-637556791210803212">
                        <div class="chatlog__content">
                            <span class="markdown"><span class="mention" title="dimxy#2587">@dimxy</span> if you can find a GUI that can define FSM and then make the fsmdefine rpc call use the output of that, it would be a great help for getting people up to speed with creating FSM</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="👌" title="👌" src="https://twemoji.maxcdn.com/2/72x72/1f44c.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">26-Oct-19 08:31 AM</span>

                    <div class="chatlog__message " data-message-id="637569024892600330" id="message-637569024892600330">
                        <div class="chatlog__content">
                            <span class="markdown">i think for deploying a FSM instance you would make a &quot;main&quot; equivalent that defines all the sub-FSM that it will use, and if a sub-FSM can have sub-sub-FSM, then there is no practical limit to the complexity of the overall FSM. though i think for vast majority of usage, a single main FSM definition opreturn with its sub-FSM and events will be more than sufficient</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="637569314253176832" id="message-637569314253176832">
                        <div class="chatlog__content">
                            <span class="markdown">so if it makes sense to limit nesting to one level, we can do that as no sense to make something able to handle 1000x the complexity that is actually needed. if we need some complex algo, we would implement that in code and then make an FSM variable/function that invokes it, so a very compact FSM definition can do some very powerful things</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">26-Oct-19 06:59 PM</span>

                    <div class="chatlog__message " data-message-id="637726920146157571" id="message-637726920146157571">
                        <div class="chatlog__content">
                            <span class="markdown">I cannot find yet any GUI examples which defines FSM but I can find many backward examples when a GUI is driven by a FSM. But I don&#39;t see any problems, with some existing FSM implementations as a base, to develop a json structure for definition of state list, event list and transition map for fsmdefine.
What is more tricky thing is to design state actions and event conditions for flexible internal events, as this involves some kind of expressions on chain values (for example to check if some timeout passed or amount is reached). I think we could develop some simple expression language which is defined on blockchain artefacts, so we need to enumerate such artefacts and assign identifiers for them (like &#39;ht&#39; as height, &#39;t&#39; as timeout etc). Such expressions might be associated with states and events.
---
Another question is do we really want external dapps for evaluation of FSMs? In this case FSMs are dependent on  that whether the dapp is running and correct. As we have all the states and events inside the chain, wouldn&#39;t it be more reliable and self-contained to have the blockchain code (executed by miners) to evaluate FSMs state transitions? (maybe dapps could evaluate some additional conditions on state transitions but this would mean the FSM is not completely defined in the chain)</span>

                                <span class="chatlog__edited-timestamp" title="26-Oct-19 07:01 PM">(edited)</span>
                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/405011811511828481/890c3b2325182148e414cbfc65287323.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="Alright#0419" data-user-id="405011811511828481">Alright</span>


                <span class="chatlog__timestamp">26-Oct-19 11:00 PM</span>

                    <div class="chatlog__message " data-message-id="637787766406774786" id="message-637787766406774786">
                        <div class="chatlog__content">
                            <span class="markdown">maybe I&#39;m misunderstanding it, but it seems payments CC is half way there already</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="637787916726304784" id="message-637787916726304784">
                        <div class="chatlog__content">
                            <span class="markdown">joker added arbitrary logic to unlocks to it, just needs to be standardized?</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">27-Oct-19 06:13 PM</span>

                    <div class="chatlog__message " data-message-id="638077798858227712" id="message-638077798858227712">
                        <div class="chatlog__content">
                            <span class="markdown">Yes FSM CC will allow to create payments logic and many other logics with once developed FSM CC code by creating clear state transition model as the FSM CC&#39;s configuration</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">27-Oct-19 06:33 PM</span>

                    <div class="chatlog__message " data-message-id="638082740624949248" id="message-638082740624949248">
                        <div class="chatlog__content">
                            <span class="markdown">Modules which could be implemented with the FSM CC are those which do not require power of Turing Machine (much data to process, in particular).
I can see that another example to be implemented with FSM is Heir CC (which allows for the Heir to spend locked funds after the funds owner inactivity)</span>

                                <span class="chatlog__edited-timestamp" title="28-Oct-19 07:33 AM">(edited)</span>
                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/3.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="polycryptoblog#1173" data-user-id="406179072922746882">polycryptoblog</span>


                <span class="chatlog__timestamp">27-Oct-19 08:00 PM</span>

                    <div class="chatlog__message " data-message-id="638104823094312961" id="message-638104823094312961">
                        <div class="chatlog__content">
                            <span class="markdown"><span class="mention" title="dimxy#2587">@dimxy</span>  I’m not sure if this will help you out,  but if I understood right you are looking for a GUI that can define FSM,  it’s pretty simplistic and not as general purpose as it’s made for PLC’s  , but I know you can do such with RSLogix emulator . <a href="https://www.splatco.com/fsm_in_ladder.htm">https://www.splatco.com/fsm_in_ladder.htm</a></span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="👍" title="👍" src="https://twemoji.maxcdn.com/2/72x72/1f44d.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">28-Oct-19 08:12 AM</span>

                    <div class="chatlog__message " data-message-id="638288910648082447" id="message-638288910648082447">
                        <div class="chatlog__content">
                            <span class="markdown">to be able to scale to arbitrary number of active FSM, i dont think it is practical to have the blockchain (everynode) scanning for all possible events. just like nspv is designed to reduce network bandwidth usage, FSM needs to reduce the workload on each node</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="🤔" title="🤔" src="https://twemoji.maxcdn.com/2/72x72/1f914.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">29-Oct-19 07:44 AM</span>

                    <div class="chatlog__message " data-message-id="638644337567334410" id="message-638644337567334410">
                        <div class="chatlog__content">
                            <span class="markdown">CHIPS poker needs a cashier functionality. Initially we will use a multisig to lock and release funds, but this requires these multisig nodes to be online all the time and also to not collude, so the ideal solution is to have a cashier CC, which if run on a pegged chain backed by KMD allows betting with known amounts</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638644637518790656" id="message-638644637518790656">
                        <div class="chatlog__content">
                            <span class="markdown">the cashier CC should be abstracted from the actual gameplay so it wont need to be contaminated with poker specific knowledge. this will allow the cashier CC to be used for any multiplayer game where player balances can be known.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638645208543657987" id="message-638645208543657987">
                        <div class="chatlog__content">
                            <span class="markdown">in order for this to be game independent, each game will need to build into its protocol signed attestation of player balances, probably after each game is completed. So we will have a list of pubkeys and balances, with signatures from either the same set of pubkeys or a slightly different set (dealer, BVV nodes, watchers)</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638645309886562335" id="message-638645309886562335">
                        <div class="chatlog__content">
                            <span class="markdown">a player can submit a withdraw only to their pubkey, so we avoid false claims using valid attestations</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638645598127652904" id="message-638645598127652904">
                        <div class="chatlog__content">
                            <span class="markdown">working backwards, it means that when depositing funds to the cashier CC, the list of valid pubkeys for the attestation needs to be given. Also, it is possible this list will change as players change, so there would need to be a way to update the list of valid attestation pubkeys</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638645689538314240" id="message-638645689538314240">
                        <div class="chatlog__content">
                            <span class="markdown"><span class="mention" title="sg777#2257">@sg777</span> details on cashier CC</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="638645931826216961" id="message-638645931826216961">
                        <div class="chatlog__content">
                            <span class="markdown"><span class="mention" title="dimxy#2587">@dimxy</span> we should be able to make a FSM instance that implements cashier CC, states include new state, initial deposit, updating attestation pubkey, withdraw</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="👍" title="👍" src="https://twemoji.maxcdn.com/2/72x72/1f44d.png" />
                                    <span class="chatlog__reaction-count">7</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">29-Oct-19 10:54 AM</span>

                    <div class="chatlog__message " data-message-id="638692133188010004" id="message-638692133188010004">
                        <div class="chatlog__content">
                            <span class="markdown"><a href="https://medium.com/@jameslee777/multichain-decentralized-cashier-for-gaming-110297ced95f">https://medium.com/@jameslee777/multichain-decentralized-cashier-for-gaming-110297ced95f</a></span>

                        </div>


                        <div class="chatlog__embed">
                            <div class="chatlog__embed-color-pill" style="background-color: rgba(79,84,92,255)"></div>
                            <div class="chatlog__embed-content-container">
                                <div class="chatlog__embed-content">
                                    <div class="chatlog__embed-text">

                                            <div class="chatlog__embed-title">
                                                    <a class="chatlog__embed-title-link" href="https://medium.com/@jameslee777/multichain-decentralized-cashier-for-gaming-110297ced95f"><span class="markdown">Multichain decentralized cashier for gaming</span></a>
                                            </div>

                                        <div class="chatlog__embed-description"><span class="markdown">It has taken many years to finally be able to put together a fully decentralized system for one of the most demanding usecases, realtime…</span></div>

                                    </div>

                                </div>


                            </div>
                        </div>

                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="💯" title="💯" src="https://twemoji.maxcdn.com/2/72x72/1f4af.png" />
                                    <span class="chatlog__reaction-count">6</span>
                                </div>
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="KMD" title="KMD" src="https://cdn.discordapp.com/emojis/600758952182939658.png" />
                                    <span class="chatlog__reaction-count">6</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">30-Oct-19 02:25 PM</span>

                    <div class="chatlog__message " data-message-id="639107682938257408" id="message-639107682938257408">
                        <div class="chatlog__content">
                            <span class="markdown">I tried to draw diagram for the Cashier FSM</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639107738793672753" id="message-639107738793672753">
                        <div class="chatlog__content">
                            <span class="markdown">Cashier FSM</span>

                        </div>

                        <div class="chatlog__attachment">
                            <a href="https://cdn.discordapp.com/attachments/466507187842187264/639107737933971468/unknown.png">
                                
                                    <img class="chatlog__attachment-thumbnail" src="https://cdn.discordapp.com/attachments/466507187842187264/639107737933971468/unknown.png" />
                            </a>
                        </div>


                    </div>
                    <div class="chatlog__message " data-message-id="639107922575491082" id="message-639107922575491082">
                        <div class="chatlog__content">
                            <span class="markdown">The point is it turns out we need a compound FSM</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 02:26 PM</span>

                    <div class="chatlog__message " data-message-id="639107953227464733" id="message-639107953227464733">
                        <div class="chatlog__content">
                            <span class="markdown">i think the cashier doesnt (shouldnt) need to know about other players</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639108034488172575" id="message-639108034488172575">
                        <div class="chatlog__content">
                            <span class="markdown">the cashier is on a per user basis, not linked to the gameplay directly</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">30-Oct-19 02:27 PM</span>

                    <div class="chatlog__message " data-message-id="639108140616515604" id="message-639108140616515604">
                        <div class="chatlog__content">
                            <span class="markdown">okay, I&#39;ll review that</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 02:28 PM</span>

                    <div class="chatlog__message " data-message-id="639108300893585418" id="message-639108300893585418">
                        <div class="chatlog__content">
                            <span class="markdown">it is like at a real casino. when you go to cashier, it doesnt matter about any other player</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639108506804289542" id="message-639108506804289542">
                        <div class="chatlog__content">
                            <span class="markdown">each player locks funds and gets chips. in our case, the chips are tied to a specific table and a set of pubkeys, the less knowledge of the games the cashier has, the more general it will be</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639109531212840985" id="message-639109531212840985">
                        <div class="chatlog__content">
                            <span class="markdown">and i think it is a very simple FSM. starting from the initial event, of making a deposit. this create a proof of deposit that can be used by the table as it sees fit.
A. deposit that creates cross chain proof -&gt; B. 
B. submits attested pubkey change -&gt; B.
B. submits attested cashout -&gt; pays to pubkey</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639109739569217537" id="message-639109739569217537">
                        <div class="chatlog__content">
                            <span class="markdown">on the cashier chain, it only sees the deposit that locks funds. this should create all the data needed for importing chips into a table, but that is all offchain as far as the cashier is concerned.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639109803284758538" id="message-639109803284758538">
                        <div class="chatlog__content">
                            <span class="markdown">oh. i guess all funds for a specific table need to be locked into the same CC address!</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639109926857474058" id="message-639109926857474058">
                        <div class="chatlog__content">
                            <span class="markdown">i see why you had more players involved. it isnt really more players, but just a shared locked address</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639110010277855237" id="message-639110010277855237">
                        <div class="chatlog__content">
                            <span class="markdown">so the locked address needs to be based on table pubkey</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639110281003401238" id="message-639110281003401238">
                        <div class="chatlog__content">
                            <span class="markdown">then i think it can be independent of different players. the logic is that a single table cannot create coins, that it is a zero sum game. so when the cashout event is submitted, the table that isnt 51% attacked will have an amount that is less than the total funds in the tables locked funds</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639110446539866118" id="message-639110446539866118">
                        <div class="chatlog__content">
                            <span class="markdown">of course if an attested cashout arrives that is more than funds locked for a table, that means some funny business happened, but it would fail due to not enough inputs. a table that cheats will only affect players on that table</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639110721988198400" id="message-639110721988198400">
                        <div class="chatlog__content">
                            <span class="markdown">so to create a deposit, it needs table pubkey (which would likely make a 1of2 address with the global CC address) authorized pubkeys for attestation.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639110873482526741" id="message-639110873482526741">
                        <div class="chatlog__content">
                            <span class="markdown">then the only things that i think can happen are that the set of attestation pubkeys changes or a cashout arrives</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639111039241158668" id="message-639111039241158668">
                        <div class="chatlog__content">
                            <span class="markdown">store the current state in the opreturn data, so just looking at the prior tx you can know the current state, make sure it is a valid event and go to the new state</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639111602154504202" id="message-639111602154504202">
                        <div class="chatlog__content">
                            <span class="markdown">the cashier template i think has 2 states (3 if you count the initial state of not existing), the first thing that happens is a deposit is made. now the cashier FSM has a specific txid that refers to a specific table and player. i guess we need to add another state to allow adding more funds, or i guess that is an event in state B after the initial creation</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639112158486986785" id="message-639112158486986785">
                        <div class="chatlog__content">
                            <span class="markdown">A gets table pubkey, player pubkey and authorized attestors and locks the amount in table dependent CC address. Now we have a txid for that player/table. What happens if the player makes another FSM instance? i think it is ok, there can be N instances, but when the player cashes out it would aggregate all of the remaining balance and now the user is able to do a withdraw</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639112724516831242" id="message-639112724516831242">
                        <div class="chatlog__content">
                            <span class="markdown">A. Create instance, B. event loop where it can be more deposit, change of authorized pubkeys, cashout
cashout would make any other instance for the player/pubkey invalid. probably a good idea to make it so a specific player/pubkey can only have one active FSM instance at a time with a baton, that avoids the orphaned FSM instances</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639113018042482689" id="message-639113018042482689">
                        <div class="chatlog__content">
                            <span class="markdown">i guess it would be good to first make a cashier CC details, with rpc calls, opreturn data, etc. and then once we have that see how to do it as a FSM</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 02:57 PM</span>

                    <div class="chatlog__message " data-message-id="639115757120126986" id="message-639115757120126986">
                        <div class="chatlog__content">
                            <span class="markdown">if you think about it, the cashier CC/FSM can be used for any pooling of funds where it is later distributed out to different pubkeys. It could be used for fund raising, where the authorized pubkeys are escrows who would then be able to decide how to allocate the funds, ie. to release it to the project or to refund to the investors. Each reciepient would just need to do a deposit for a small amount.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639115988876656651" id="message-639115988876656651">
                        <div class="chatlog__content">
                            <span class="markdown">it could be used to manage funds for a company, where the distributions go to the various departments on the approval of the finance pubkeys</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639116546576220160" id="message-639116546576220160">
                        <div class="chatlog__content">
                            <span class="markdown">i think the name cashier might color the thinking to just the gaming aspect, what we have is a generalized pooling and distribution based on authorized pubkeys functionality. By making the pubkeys the peers you are playing the poker with, it becomes a decentralized poker cashier, by making the pubkeys the escrows for investment funds release, it becomes a way for managing fund raising, by having the authorized pubkeys being finance and management, it can be used to allocate funds across a company</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639116918544007178" id="message-639116918544007178">
                        <div class="chatlog__content">
                            <span class="markdown">i guess we need to add another event to make it a bit more general and have a timeout event, so if X amount of time passes (a big number relative to expected timeframes), the initial contributor can withdraw the contributed amounts. therefore, each opreturn should remember the total deposited by each &quot;player&quot;. better to have more data than actually needed</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 03:10 PM</span>

                    <div class="chatlog__message " data-message-id="639119004556066876" id="message-639119004556066876">
                        <div class="chatlog__content">
                            <span class="markdown">it seems &quot;deposit to tableaddress&quot; is an event that can be the trigger for a lot of state changes. a player/table address can have a baton, table address the locked funds. so the cashier FSM description would have blanks for these details, but they are filled in when creating an instance</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="shexy" title="shexy" src="https://cdn.discordapp.com/emojis/464184005038702594.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 06:18 PM</span>

                    <div class="chatlog__message " data-message-id="639166239339708426" id="message-639166239339708426">
                        <div class="chatlog__content">
                            <span class="markdown"><span class="mention" title="dimxy#2587">@dimxy</span> following is in no way complete or correct, but just to give you an idea of what i have in mind as far as defining the FSM:
<div class="pre pre--multiline nohighlight">[{&quot;state&quot;:&quot;init&quot;,&quot;events&quot;:[
{&quot;paid&quot;:&quot;&lt;table&gt;,&quot;baton&quot;:&quot;&lt;table + player&gt;,&quot;M&quot;:&lt;n/2+1&gt;,&quot;pubkeys&quot;:[&quot;&quot;,&quot;&quot;,...],&quot;next&quot;:&quot;idle&quot;]},
 {&quot;state&quot;:&quot;idle&quot;,&quot;events&quot;:[{&quot;paid&quot;:&quot;&lt;table&gt;,&quot;next&quot;:&quot;idle&quot;}, {&quot;cmd&quot;:&quot;newpubs&quot;,&quot;pubkeys&quot;:[&quot;&quot;,&quot;&quot;,...]}. {&quot;timeout&quot;:100000,&quot;next&quot;:&quot;end&quot;,&quot;action&quot;:&quot;refund&quot;}, {&quot;attestation&quot;:&lt;signatures+data&gt;,&quot;next&quot;:&quot;end&quot;,&quot;action&quot;:&quot;redeem&quot;}]}]</div></span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639166720535166976" id="message-639166720535166976">
                        <div class="chatlog__content">
                            <span class="markdown">the FSM is defined by an array of states, each state has an array of events. the hard part is encoding all the possible events and making sure all the required actions are supported. it seems this one needs a flag to indicate it is approved by authorized signatures. other FSM could just change states based on blockchain events, like timestamps, blockheights, equations with synthetics</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639167074744401941" id="message-639167074744401941">
                        <div class="chatlog__content">
                            <span class="markdown">so the spec you write will need to carefully list out all the possible events and actions. the state transitions can just be done via the parsed JSON that wont take much time to calculate. and making sure a new state transition transaction properly fits the required event description will likely need a lot more fields to be fully useful.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639167188770488320" id="message-639167188770488320">
                        <div class="chatlog__content">
                            <span class="markdown">not totally happy with the above JSON, but at least it is a start and only halfway broken and incomplete</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639167243674189824" id="message-639167243674189824">
                        <div class="chatlog__content">
                            <span class="markdown">special states of &quot;init&quot; and &quot;end&quot;</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639167669957820451" id="message-639167669957820451">
                        <div class="chatlog__content">
                            <span class="markdown">the &lt;&gt; and [&quot;&quot;, &quot;&quot;, ...] values are filled in with the actual addresses/pubkeys and submitted in the opreturn of the init tx, the txid from that is then used for all the other FSM tx. with appropriate data in the opreturn (parameters, state data, return values)</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639168249459638295" id="message-639168249459638295">
                        <div class="chatlog__content">
                            <span class="markdown">notice the &quot;events&quot; objects are quite flexible, we can have an event that is a state transition of a specific FSM, it just needs to already exist. so on an &quot;idle&quot; -&gt; &quot;end&quot; transition of a specific FSM txid, that can be an event in a different FSM. this allows the nesting of FSM. it can also require a specific event that causes the state transition, or it can just generate the even if the FSM is in a certain state.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639168708178345984" id="message-639168708178345984">
                        <div class="chatlog__content">
                            <span class="markdown">i hope you are getting closer to what i have in mind with all this. in 10kb of JSON, we can specify quite a lot of complexity and with nested events, a 10kb sub-statemachines actions can feed into the next level up. i doubt we need to get anywhere near that complexity, but it all comes for free with this method</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">30-Oct-19 06:41 PM</span>

                    <div class="chatlog__message " data-message-id="639172129341964301" id="message-639172129341964301">
                        <div class="chatlog__content">
                            <span class="markdown">Thank you for this.
I&#39;m trying to create a FSM specification which key element is also a json defining states, events and transition map.
To make it common to be able to create wide variety of applications I&#39;m trying to define logical conditions allowing events to occur.
Such expressions will be executed on blockchain artefacts like address, txout, height, time and it will require a basic set of functions which could be used in the expressions. Maybe studying several FSMs like cashier, payments, heir we could understand this functionality.
(the current status is: <a href="https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC)">https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC)</a></span>

                        </div>


                        <div class="chatlog__embed">
                            <div class="chatlog__embed-color-pill" style="background-color: rgba(30,35,39,1)"></div>
                            <div class="chatlog__embed-content-container">
                                <div class="chatlog__embed-content">
                                    <div class="chatlog__embed-text">

                                            <div class="chatlog__embed-title">
                                                    <a class="chatlog__embed-title-link" href="https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC)"><span class="markdown">dimxy/komodo</span></a>
                                            </div>

                                        <div class="chatlog__embed-description"><span class="markdown">Komodo. Contribute to dimxy/komodo development by creating an account on GitHub.</span></div>

                                    </div>

                                        <div class="chatlog__embed-thumbnail-container">
                                            <a class="chatlog__embed-thumbnail-link" href="https://avatars0.githubusercontent.com/u/21120539?s=400&v=4">
                                                <img class="chatlog__embed-thumbnail" src="https://avatars0.githubusercontent.com/u/21120539?s=400&v=4" />
                                            </a>
                                        </div>
                                </div>


                            </div>
                        </div>

                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 06:47 PM</span>

                    <div class="chatlog__message " data-message-id="639173453831733248" id="message-639173453831733248">
                        <div class="chatlog__content">
                            <span class="markdown">yes, very good, we are thinking along the same lines</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639173939788120065" id="message-639173939788120065">
                        <div class="chatlog__content">
                            <span class="markdown">since we have a 10kb size limit, maybe we have a human readable JSON, which is then machine converted to much more compact form, there is no need to put onchain field names that are very long, but this is a size optimization to do after we get everything defined. I guess we can use the JSON encoder i made, it is quite efficient at lossless compression of JSON.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639174478823424001" id="message-639174478823424001">
                        <div class="chatlog__content">
                            <span class="markdown">building in support for common things like batons will enable mutual exclusion of spending, which is quite important in a lot of cases, oracles, nested FSM, yes this is all coming together and will be quite powerful. using JSON you can define a new FSM that basically implements cashier, payments, heir, faucet CC. I guess we might just try to make sure the FSM can be created for most of the existing simpler CC?</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639175393160593450" id="message-639175393160593450">
                        <div class="chatlog__content">
                            <span class="markdown"><a href="https://blog.acolyer.org/2018/03/20/designing-secure-ethereum-smart-contracts-a-finite-state-machine-approach/">https://blog.acolyer.org/2018/03/20/designing-secure-ethereum-smart-contracts-a-finite-state-machine-approach/</a></span>

                        </div>


                        <div class="chatlog__embed">
                            <div class="chatlog__embed-color-pill" style="background-color: rgba(255,255,255,1)"></div>
                            <div class="chatlog__embed-content-container">
                                <div class="chatlog__embed-content">
                                    <div class="chatlog__embed-text">
                                            <div class="chatlog__embed-author">

                                                    <span class="chatlog__embed-author-name">
                                                            <a class="chatlog__embed-author-name-link" href="https://blog.acolyer.org/author/adriancolyer/">adriancolyer</a>
                                                    </span>
                                            </div>

                                            <div class="chatlog__embed-title">
                                                    <a class="chatlog__embed-title-link" href="https://blog.acolyer.org/2018/03/20/designing-secure-ethereum-smart-contracts-a-finite-state-machine-approach/"><span class="markdown">Designing secure Ethereum smart contracts: a finite state machine ...</span></a>
                                            </div>

                                        <div class="chatlog__embed-description"><span class="markdown">Designing secure Ethereum smart contracts: a finite state machine based approach Mavridou &amp; Laszka, FC’18 You could be forgiven for thinking I’m down on smart contracts, but I actually think th…</span></div>

                                    </div>

                                        <div class="chatlog__embed-thumbnail-container">
                                            <a class="chatlog__embed-thumbnail-link" href="https://adriancolyer.files.wordpress.com/2018/03/fsolidm-access.jpeg?w=480">
                                                <img class="chatlog__embed-thumbnail" src="https://adriancolyer.files.wordpress.com/2018/03/fsolidm-access.jpeg?w=480" />
                                            </a>
                                        </div>
                                </div>


                            </div>
                        </div>

                    </div>
                    <div class="chatlog__message " data-message-id="639175495992344577" id="message-639175495992344577">
                        <div class="chatlog__content">
                            <span class="markdown">above seems to be thinking along the same lines, but we can make the output run at native speeds without GAS costs</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639175976760246282" id="message-639175976760246282">
                        <div class="chatlog__content">
                            <span class="markdown">unexpected source, but actuall somewhat relevant <a href="https://craigwright.net/blog/bitcoin-blockchain-tech/finite-state-machines-in-script/">https://craigwright.net/blog/bitcoin-blockchain-tech/finite-state-machines-in-script/</a></span>

                        </div>


                        <div class="chatlog__embed">
                            <div class="chatlog__embed-color-pill" style="background-color: rgba(79,84,92,255)"></div>
                            <div class="chatlog__embed-content-container">
                                <div class="chatlog__embed-content">
                                    <div class="chatlog__embed-text">

                                            <div class="chatlog__embed-title">
                                                    <a class="chatlog__embed-title-link" href="https://craigwright.net/blog/bitcoin-blockchain-tech/finite-state-machines-in-script/"><span class="markdown">Finite State Machines in Script</span></a>
                                            </div>


                                    </div>

                                        <div class="chatlog__embed-thumbnail-container">
                                            <a class="chatlog__embed-thumbnail-link" href="https://craigwright.net/wp-content/uploads/2019/04/1-KrIEdYvJ-exNPAFvSB6FNw.png">
                                                <img class="chatlog__embed-thumbnail" src="https://craigwright.net/wp-content/uploads/2019/04/1-KrIEdYvJ-exNPAFvSB6FNw.png" />
                                            </a>
                                        </div>
                                </div>


                            </div>
                        </div>

                    </div>
                    <div class="chatlog__message " data-message-id="639176293719605268" id="message-639176293719605268">
                        <div class="chatlog__content">
                            <span class="markdown"><a href="https://arxiv.org/pdf/1906.02906.pdf">https://arxiv.org/pdf/1906.02906.pdf</a></span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639176413215195187" id="message-639176413215195187">
                        <div class="chatlog__content">
                            <span class="markdown">some FSM examples in the PDF: Smart Contract Design Meets State Machine Synthesis: Case Studies</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">30-Oct-19 07:23 PM</span>

                    <div class="chatlog__message " data-message-id="639182564032118784" id="message-639182564032118784">
                        <div class="chatlog__content">
                            <span class="markdown">This will allow to create many new applications based on well-defined formal models and unified and clean supporting code. I think it will be a very big advancement in blockchain technology.
(I also thought about FSM visualization: there is UML state diagram spec and standard XML metadata interchange format, XMI, for storing models, supported by many UML editors, which could be parsed and transformed into json definition or for reverse engineering for documentation creation)</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">30-Oct-19 07:27 PM</span>

                    <div class="chatlog__message " data-message-id="639183574645473311" id="message-639183574645473311">
                        <div class="chatlog__content">
                            <span class="markdown">yes, it seems this is the way to fully solve the scalable smart contract problem. let us do it completely and correctly</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="3040_kingpeepo" title="3040_kingpeepo" src="https://cdn.discordapp.com/emojis/523246286908948481.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 12:52 PM</span>

                    <div class="chatlog__message " data-message-id="639446659172139018" id="message-639446659172139018">
                        <div class="chatlog__content">
                            <span class="markdown">At first I thought the cashier should issue chips in exchange of deposited coins. Now I see he does not (as this is done in another chain, seems, by the dealer)
That is, the cashier just receives coins on the some cc address and allows to withdraw funds from this addreess within some balance which is attested by pubkeys.
So I draw a new diagram
---
A question that might be to study yet: seems that as many users can deposit or withdraw funds concurrently this means that a new Cashier FSM instance should exist for each user. But if the task is to make FSM for actually a pooled account maybe we need it as an aggregated FSM for several depositing users. Such FSM should wait while all the participants have made deposits, then close accepting deposits and switch to a state of waiting for users cashout events).
---
Anyway, this is the diagram for case one fsm instance == one user pubkey
(it additionally supports &#39;refund if timeout passed&#39; event)</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639446798288683008" id="message-639446798288683008">
                        <div class="chatlog__content">
                            <span class="markdown">Cashier FSM (changed)</span>

                        </div>

                        <div class="chatlog__attachment">
                            <a href="https://cdn.discordapp.com/attachments/466507187842187264/639446797827440666/unknown.png">
                                
                                    <img class="chatlog__attachment-thumbnail" src="https://cdn.discordapp.com/attachments/466507187842187264/639446797827440666/unknown.png" />
                            </a>
                        </div>


                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 02:02 PM</span>

                    <div class="chatlog__message " data-message-id="639464111700312109" id="message-639464111700312109">
                        <div class="chatlog__content">
                            <span class="markdown">the cashier never closes</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639464179194920980" id="message-639464179194920980">
                        <div class="chatlog__content">
                            <span class="markdown">it is open ended and each user would have a separate cashier instance per table</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639464359285751810" id="message-639464359285751810">
                        <div class="chatlog__content">
                            <span class="markdown">there is no need to wait for all users, as some users wont arrive for many hours</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639464420489035777" id="message-639464420489035777">
                        <div class="chatlog__content">
                            <span class="markdown">2 players arrive, start playing, then half an hour later another player arrives</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639464615813840897" id="message-639464615813840897">
                        <div class="chatlog__content">
                            <span class="markdown">so you see, it needs to be totally independent and the total balance of the table is the responsibility of the authorized signers to make sure it is a zero sum game. as long as that is the case, the attested withdraw totals will be correct</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639464655739158528" id="message-639464655739158528">
                        <div class="chatlog__content">
                            <span class="markdown">i will need to study your diagram a bit later</span>

                        </div>



                        <div class="chatlog__reactions">
                                <div class="chatlog__reaction">
                                    <img class="emoji emoji--small" alt="👌" title="👌" src="https://twemoji.maxcdn.com/2/72x72/1f44c.png" />
                                    <span class="chatlog__reaction-count">1</span>
                                </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 02:09 PM</span>

                    <div class="chatlog__message " data-message-id="639465863409565700" id="message-639465863409565700">
                        <div class="chatlog__content">
                            <span class="markdown">I&#39;ll continue to work on the fsm spec then</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 02:25 PM</span>

                    <div class="chatlog__message " data-message-id="639470128966139924" id="message-639470128966139924">
                        <div class="chatlog__content">
                            <span class="markdown">your flowchart doesnt handle updating of the authorized attestors. i guess that is a bit game specific, but it is very useful to be able to change the authorized pubkeys over time. with poker it is expected to be changing as players come and go. the parameters needed would probably depend on the specific state and event combination, so we might need to define some state/event specific parameters, in addition to state specific in addition to fsm specific parameters. that way we can handle different types of parameters for the different levels</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 02:37 PM</span>

                    <div class="chatlog__message " data-message-id="639472938575200256" id="message-639472938575200256">
                        <div class="chatlog__content">
                            <span class="markdown">I wrote about this attestors change in the note in the upper-right corner.
It seems this could not implemented by events and states and it is more like fsm parameters. So it might be done with some fsm-instance rpc that allows to additionally change instance parameters after the initialization</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 02:40 PM</span>

                    <div class="chatlog__message " data-message-id="639473769588719647" id="message-639473769588719647">
                        <div class="chatlog__content">
                            <span class="markdown">why cant the idle state get a &quot;new pubkeys&quot; event?</span>

                                <span class="chatlog__edited-timestamp" title="31-Oct-19 02:40 PM">(edited)</span>
                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639474054771900436" id="message-639474054771900436">
                        <div class="chatlog__content">
                            <span class="markdown">it would go back to the idle state waiting for all the different possible events: timeout, cashout, new pubkeys</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639474201522077708" id="message-639474201522077708">
                        <div class="chatlog__content">
                            <span class="markdown">so the idle/newpubkeys would have parameters that are the pubkeys vector</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639474327393140736" id="message-639474327393140736">
                        <div class="chatlog__content">
                            <span class="markdown">along with the attestation that the pubkeys are changed to the new pubkeys</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639474428971057152" id="message-639474428971057152">
                        <div class="chatlog__content">
                            <span class="markdown">the idle/cashout would get the parameters of the attestation of player balance</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 03:08 PM</span>

                    <div class="chatlog__message " data-message-id="639480761451282432" id="message-639480761451282432">
                        <div class="chatlog__content">
                            <span class="markdown">I think, all the states should provide some meaning for the code which queries FSM for its state. So if state is &#39;Deposit Done&#39; it would mean that no more deposits are possible, and &#39;Cashout Allowed&#39; state would mean that the user can now withdraw coins. 
But what the &#39;Idle&#39; state would mean if query it? 
(Maybe we can just add such change-attestor event that would simply return back to the current state)</span>

                                <span class="chatlog__edited-timestamp" title="31-Oct-19 03:08 PM">(edited)</span>
                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 03:08 PM</span>

                    <div class="chatlog__message " data-message-id="639480939252154368" id="message-639480939252154368">
                        <div class="chatlog__content">
                            <span class="markdown">why do you constrain yourself so that a state is only allowed one event to happen?</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481081975930885" id="message-639481081975930885">
                        <div class="chatlog__content">
                            <span class="markdown">if you name your states too literally, maybe it makes it hard to view it flexibly?</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481127467483136" id="message-639481127467483136">
                        <div class="chatlog__content">
                            <span class="markdown">i had 2 states, &quot;init&quot; and &quot;idle&quot;</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481407210520605" id="message-639481407210520605">
                        <div class="chatlog__content">
                            <span class="markdown">init state is the first tx that creates the FSM instance and it goes to the &quot;idle&quot; state. almost all events now just loop back to idle state. from idle state it can do anything, based on a specific event. and event can be anything. you need to think about this more generally</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481477637210112" id="message-639481477637210112">
                        <div class="chatlog__content">
                            <span class="markdown">i guess there is the third state of &quot;end&quot; where the FSM instance is over</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481575951826984" id="message-639481575951826984">
                        <div class="chatlog__content">
                            <span class="markdown">so with just three states of init, idle, end you can make quite a lot of different state machines</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481673548955648" id="message-639481673548955648">
                        <div class="chatlog__content">
                            <span class="markdown">it then becomes all about what type of &quot;events&quot; are allowed.</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639481960883945502" id="message-639481960883945502">
                        <div class="chatlog__content">
                            <span class="markdown">if to view the FSM as having a specific configuration, then we can have events that modify that configuration and maybe there are a lot of these, along with the deposit, refund, cashout events where funds are transferred</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639482235048951809" id="message-639482235048951809">
                        <div class="chatlog__content">
                            <span class="markdown">it could be that we can cover majority of usecases with the init/idle/end state machine states, but no sense to limit the FSM CC to such a simplistic state machine</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 03:54 PM</span>

                    <div class="chatlog__message " data-message-id="639492410845691914" id="message-639492410845691914">
                        <div class="chatlog__content">
                            <span class="markdown">I did not mean that a state is limited by only one event, it could be several different events that cause transition to this event or several events that move from this state to other states.
I just thought for each real-world state we would want its equivalent in a FSM.
For example, for the Cashier FSM how will we differ if a pubkey is allowed to withdraw coins if we do not have a corresponding state? If we have only &#39;idle&#39; state we would need to analyze the preceding events (like if the &#39;attested balance&#39; event already happened) but if so why to have states?
So the FSM processes events internally and moves from state to state accordingly. And there is code which queries the FSM state and does some actions based on this. For example, for Cashier there should be an rpc which withdraws coins from the TableAddress. This code would query the FSM state and if it is in the &#39;Cashout Allowed&#39; state it withdraws coins (or not if state in another). If we do not have such &#39;Cashout Allowed&#39; state and have &#39;Idle&#39; state instead this rpc should check for &#39;attested-balance&#39; event, but the first case seems for me more structured and dividing code responsibilities. 
(So we will need for each application case to draw its own state machine and events, but we could do it with no coding if we have a json config and sufficient set of functions on blockchain artefacts)</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 03:56 PM</span>

                    <div class="chatlog__message " data-message-id="639492983036706826" id="message-639492983036706826">
                        <div class="chatlog__content">
                            <span class="markdown">i guess as long as it properly solves the problem at hand, there are many valid statemachines that will achieve this</span>

                        </div>



                    </div>
                    <div class="chatlog__message " data-message-id="639493069208682496" id="message-639493069208682496">
                        <div class="chatlog__content">
                            <span class="markdown">the important thing is for FSM CC to be able to handle whichever way the fsm designer wants it done</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">31-Oct-19 04:01 PM</span>

                    <div class="chatlog__message " data-message-id="639494094250311720" id="message-639494094250311720">
                        <div class="chatlog__content">
                            <span class="markdown">Seems we need to move on with the FSM specification and see how it would solve our cases</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">31-Oct-19 04:04 PM</span>

                    <div class="chatlog__message " data-message-id="639494821987483672" id="message-639494821987483672">
                        <div class="chatlog__content">
                            <span class="markdown">yes</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/507209916449292303/1b54deb9b119d8c0de2aa252c8f06edf.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="dimxy#2587" data-user-id="507209916449292303">dimxy</span>


                <span class="chatlog__timestamp">01-Nov-19 01:05 PM</span>

                    <div class="chatlog__message " data-message-id="639812353159856148" id="message-639812353159856148">
                        <div class="chatlog__content">
                            <span class="markdown">When Cashier is provided with attestors-pubkeys how does it validate these pubkeys?
Or is it supposed that the pubkeys are sent from the Cashier instance&#39;s creator and Cashier trusts them because of this?</span>

                        </div>



                    </div>
            </div>
        </div>
        <div class="chatlog__message-group">
            <div class="chatlog__author-avatar-container">
                <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" />
            </div>
            <div class="chatlog__messages">
                <span class="chatlog__author-name" title="jl777c#5810" data-user-id="455741312273219595">jl777c</span>


                <span class="chatlog__timestamp">01-Nov-19 02:01 PM</span>

                    <div class="chatlog__message " data-message-id="639826332246868028" id="message-639826332246868028">
                        <div class="chatlog__content">
                            <span class="markdown">the initial set is sent with the original deposit</span>

                        </div>



                    </div>
            </div>
        </div>
</div>

</body>
</html>
