==============================================================
Guild: Komodo
Channel: cc-prices
Topic: ./komodod -ac_cbopret=7 -ac_prices="LTC, BCHABC, XMR, IOTA, ZEC, WAVES, LSK, DCR, RVN, DASH, XEM, BTS, ICX, HOT, STEEM, ENJ, STRAT" -pubkey=<yourpubkey> -ac_name=REKT0 -ac_cclib=prices -ac_cc=10777 -ac_reward=3000000000 -ac_supply=120000000 -ac_pubkey=039433dc3749aece1bd568f374a45da3b0bc6856990d7da3cd175399577940a775 -ac_perc=77777 -ac_blocktime=600 -addnode=5.9.102.210 &
Messages: 100
Range: before 05-Dec-19 12:00 AM
==============================================================

[02-May-19 08:35 AM] jl777c#5810
what about losses?

[02-May-19 08:36 AM] TonyL#3577
In case of losses just index becoming cheaper
ICO back from 2016, was my first cryptoinvestment - but not the best one so sold 😃

[02-May-19 08:36 AM] jl777c#5810
not sure how to give creator of a synthetic any percentage...

[02-May-19 08:37 AM] jl777c#5810
seems like "why would people pay percentage of profits for a portfolio construction" ?

[02-May-19 08:38 AM] TonyL#3577
It's a thingy from classic investment funds - "management fee" and so on

[02-May-19 08:38 AM] TonyL#3577
And usually it's not only construction but rebalancing also

[02-May-19 08:38 AM] jl777c#5810
oh, rebalancing! ok then, take my 10%

[02-May-19 08:38 AM] TonyL#3577
😃

[02-May-19 08:40 AM] TonyL#3577
Markowitz and modern-Markowitz things not working well on such amateur market imo because everything too corelated each other so I think these guys using "blind monkey" rebalancing approach

[02-May-19 08:41 AM] jl777c#5810
the bling monkey. forgot about that one

[02-May-19 08:41 AM] jl777c#5810
we can put various stocks to the DTO to allow better hedging

[02-May-19 08:41 AM] TonyL#3577
Oh it supposed to be "blind"

[02-May-19 08:41 AM] TonyL#3577
It's from experiment when monkey smashing typing machine

[02-May-19 08:41 AM] jl777c#5810
but being able to use negative margin allows for perfect hedging

[02-May-19 08:41 AM] TonyL#3577
And in some cases it might be word as output

[02-May-19 08:42 AM] jl777c#5810
yes, darts thrown at the newspaper listings of stock

{Reactions}
💯 

[02-May-19 08:43 AM] TonyL#3577
I modeled portfolios last year - random guess in porfolio constructing usually perform at least not worse as some models

[02-May-19 08:44 AM] TonyL#3577
Especially when everything corellated 😃

[02-May-19 08:45 AM] TonyL#3577
But interesting direction might be some "trader profile" and "trading stats", with possibility to compete in tournaments and some Etoro-like trader following / trades copying

[02-May-19 08:45 AM] TonyL#3577
Social trading they call it

[02-May-19 08:46 AM] jl777c#5810
can track performance of pubkey

[02-May-19 08:46 AM] jl777c#5810
and just copy what they do

[02-May-19 08:47 AM] TonyL#3577
Aha, just need interface for it

[02-May-19 08:47 AM] TonyL#3577
To find the best 😃

[02-May-19 08:48 AM] jl777c#5810
it sounds like things are mostly working?

[02-May-19 08:49 AM] jl777c#5810
maybe it is time to make a sidechain for BET with some stocks and more cryptos. then people can bet with real funds

[02-May-19 08:49 AM] jl777c#5810
I can fund it with some BET to get things started

[02-May-19 08:49 AM] dimxy#2587
tokens support is to be added yet

[02-May-19 08:49 AM] dimxy#2587
plus we turned off the validation

[02-May-19 08:49 AM] jl777c#5810
yes and global risk management, but based on the min/max, it seems we might be ok on the risk side

[02-May-19 08:50 AM] jl777c#5810
yes, so for the new chain, validation enabled, after adding whatever other validations

[02-May-19 08:50 AM] TonyL#3577
It looks like casino all the time in plus atm 😃

{Reactions}
👍 

[02-May-19 08:50 AM] jl777c#5810
the DTO is going steady on all the nodes, for almost a month after last fix

[02-May-19 08:51 AM] jl777c#5810
just one lucky bet at 100x margin will eat the profits from a lot of other bets

[02-May-19 08:52 AM] dimxy#2587
BTW we dd not check much cashout and rekt. Interesting what would happen to the fund

[02-May-19 08:53 AM] jl777c#5810
ok, lets check those things and if there is a way to limit betsize*leverage based on global funds

[02-May-19 08:53 AM] TonyL#3577
Oh yes, I tested cashout few times and it worked fine. But never rekted my bets

[02-May-19 08:53 AM] jl777c#5810
the way it would work if someone wins more than available capital, they can cashout all that is left

[02-May-19 08:54 AM] jl777c#5810
then any other positions wont be able to cashout until we get enough rekt

[02-May-19 08:54 AM] jl777c#5810
maybe that is ok, it socializes the losses and it should only be an issue at the start

[02-May-19 08:54 AM] jl777c#5810
unless someone is able to consistently beat the blockchain

[02-May-19 08:59 AM] jl777c#5810
making it a sidechain will let us test sidechains at the same time and we can bet with real value before tokens support

[02-May-19 08:59 AM] TonyL#3577
Closed position with negative profit, waiting to be mined

[02-May-19 08:59 AM] jl777c#5810
we do need to make sure we are monetizing for the BET address on cashout/rekt

[02-May-19 09:00 AM] TonyL#3577
How to find current fund address?

[02-May-19 09:00 AM] jl777c#5810
did we remove the costbasis tx? it seemed there was no need for it

[02-May-19 09:01 AM] jl777c#5810
RGsW... in prices.cpp file at the end of comments

{Reactions}
👌 

[02-May-19 09:02 AM] TonyL#3577
Vouts of this cashout (c7da3682f9dcd49dc8a0c5863883f7ee05584e26f3a65e38e601041b7e5a37ba):
```  "vout": [
    {
      "value": 56.49469980,
      "valueZat": 5649469980,
      "n": 0,
      "scriptPubKey": {
        "asm": "029fe332bce5ccc040c8a13ef5a4664ae841a7b5d3ee6c3ada144c1f3f9b4e1186 OP_CHECKSIG",
        "hex": "21029fe332bce5ccc040c8a13ef5a4664ae841a7b5d3ee6c3ada144c1f3f9b4e1186ac",
        "reqSigs": 1,
        "type": "pubkey",
        "addresses": [
          "RBryyraWbHNLtxv8xY7BoUCgXjEsFU7aPb"
        ]
      }
    },
    {
      "value": 40.02030020,
      "valueZat": 4002030020,
      "n": 1,
      "scriptPubKey": {
        "asm": "a22c80203ee64ec5f134da404710d306dcd9ca54a0139b3c4827b43a988fc6316e6c2a688103120c008203000401 OP_CHECKCRYPTOCONDITION",
        "hex": "2ea22c80203ee64ec5f134da404710d306dcd9ca54a0139b3c4827b43a988fc6316e6c2a688103120c008203000401cc",
        "reqSigs": 1,
        "type": "cryptocondition",
        "addresses": [
          "RAL5Vh8NXmFqEKJRKrk1KjKaUckK7mM1iS"
        ]
      }
    },
```

[02-May-19 09:03 AM] TonyL#3577
RBryyraWbHNLtxv8xY7BoUCgXjEsFU7aPb it's my address ```"value": 56.49469980,``` and it's correct equity amount

[02-May-19 09:03 AM] TonyL#3577
But these 40 - I'm not sure where it's gone. And position size was 77 coins

[02-May-19 09:03 AM] jl777c#5810
monetization needs to be added and this gives BET coin a direct revenue stream

[02-May-19 09:03 AM] TonyL#3577
`did we remove the costbasis tx? it seemed there was no need for it` - I did cashout without costbasis tx so I think it's deprecated

{Reactions}
👌 

[02-May-19 09:04 AM] jl777c#5810
lets make sure it is totally removed and not allowed

[02-May-19 09:05 AM] TonyL#3577
```./komodo-cli -ac_name=REKT0 pricessetcostbasis bfc1ed09d48406ed251a914ff253b0733abff7ff5e89a624160d290e0f9d15ad
{
  "result": "error",
  "error": "deprecated"
}
```

[02-May-19 09:07 AM] jl777c#5810
good

[02-May-19 09:07 AM] dimxy#2587
`But these 40 - I'm not sure where it's gone`
the change I suppose

[02-May-19 09:07 AM] jl777c#5810
so just adding the monetization to rekt seems what is needed.

[02-May-19 09:08 AM] TonyL#3577
``` ./komodo-cli -ac_name=REKT0 pricesbet 77.7 777 "BTC_USD, 1"``` let's get rekt

[02-May-19 09:08 AM] jl777c#5810
the equity was in global address not as a specific utxo, just credits against the global funds

[02-May-19 09:08 AM] jl777c#5810
for cashout, i guess it should be allowed to collect less than the equity amount if there arent enough funds left

[02-May-19 09:09 AM] jl777c#5810
i would think maxleverage would need to be capped to lower amounts, until the global funds are adequate

[02-May-19 09:11 AM] TonyL#3577
We can make some "risk-management" formula for fund.
Like a not to risk more than 1% of fund with approximation that bettors have 0% ROI against us

[02-May-19 09:12 AM] jl777c#5810
ok

[02-May-19 09:15 AM] TonyL#3577
Just an idea of some determenistic level defense. Because bettors can use bankroll-management, strategies with ->inf variance like a many many steps martingale, some arbitrage maybe and autonomous fund looks very defenseless

[02-May-19 09:19 AM] TonyL#3577
It looks like I'm receiving equity correctly on cashout in case of both negative and positive profits, waiting for rekt

[02-May-19 10:18 PM] TonyL#3577
@dimxy looks like something is broken for new bets in latest updates. I'm using daemon built with DTEST mode flag. 
Profit not starting to calculate and looks like it's because last price not moving now at all. For example:
```
./komodo-cli -ac_name=REKT0 pricesinfo 22319bd052e7c63b21e290e1bf6b0d56eefd7e04b4e3f7946f9a3b6341d4a3c9
{
  "status": "open",
  "rekt": 0,
  "expression": "BTC_USD, 1",
  "reduced": "BTC_USD, 1",
  "batontxid": "22319bd052e7c63b21e290e1bf6b0d56eefd7e04b4e3f7946f9a3b6341d4a3c9",
  "costbasis": 5425.36451655,
  "bets": [
    {
      "positionsize": 77.70000000,
      "profits": 0.00000000,
      "costbasis": 5425.36451655,
      "firstheight": 4209
    }
  ],
  "leverage": 777,
  "TotalPositionSize": 77.70000000,
  "TotalProfits": 0.00000000,
  "equity": 77.70000000,
  "LastPrice": 5425.36451655,
  "LastHeight": 4278,
  "LiquidationPrice": 5418.38206544
}
```

[02-May-19 10:19 PM] TonyL#3577
Or:
```./komodo-cli -ac_name=REKT0 pricesinfo b1acadc833f92400d0a2f0f5efc19a3fa16ac55badc52892c3168585a1dcb59c
{
  "status": "open",
  "rekt": 0,
  "expression": "BTC_USD, KMD_BTC, USD_RUB, **/, 1",
  "reduced": "KMD_USD, RUB_USD, *, 1",
  "batontxid": "b1acadc833f92400d0a2f0f5efc19a3fa16ac55badc52892c3168585a1dcb59c",
  "costbasis": 0.01528985,
  "bets": [
    {
      "positionsize": 10.00000000,
      "profits": 0.00000000,
      "costbasis": 0.01528985,
      "firstheight": 4182
    }
  ],
  "leverage": 10,
  "TotalPositionSize": 10.00000000,
  "TotalProfits": 0.00000000,
  "equity": 10.00000000,
  "LastPrice": 0.01528985,
  "LastHeight": 4278,
  "LiquidationPrice": 0.01376087
}
```

[02-May-19 10:21 PM] TonyL#3577
I updated this morning and it grabbed commits which added `reduced`, but it worked same way on yesterdays commits

[03-May-19 05:12 AM] dimxy#2587
I removed test costbasis calc  as we deprecated the costbasis tx.
Seems you need this to check profit calculations? 
Ok I willl add testmode for the costbasis

[03-May-19 05:16 AM] TonyL#3577
Oh yes, I wanted to test rekt bet actually

[03-May-19 05:26 AM] dimxy#2587
And last time when TESTMODE was active it actually changed DAY_WINDOW and it looked not so good on the chart.
I think now it is better for testing to change just costbasis calculation  period to 7 blocks but for DAY_WINDOW to set it as it is now 24h

[03-May-19 05:50 AM] dimxy#2587
and there might be  implications for this test costbasis now as we now do not use costbasis tx fixing the costbasis value:
so if a position was closed in test mode but you later recompile with no testmode, the cosybasis and profits calculations will be updated and incorrect for such positions
(updated the repo with testmode)

[03-May-19 06:17 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/560714286369079299/573754963373719552/unknown.png

[03-May-19 06:17 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/560714286369079299/573755056973938689/unknown.png

[03-May-19 06:18 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/560714286369079299/573755123021643787/unknown.png

[03-May-19 06:18 AM] TonyL#3577
I'm rich whoooho

[03-May-19 06:19 AM] TonyL#3577
```{
  "status": "open",
  "rekt": 0,
  "expression": "BTC_USD, 1",
  "reduced": "BTC_USD, 1",
  "batontxid": "e19b1e12259efe3a37864deab312c4eabdbb1e8422c42bbde381ced43d3ebe69",
  "costbasis": 5402.05559655,
  "costbasis_test_period": 7,
  "bets": [
    {
      "positionsize": 77.70000000,
      "profits": 499.93591032,
      "costbasis": 5402.05559655,
      "firstheight": 4204
    }
  ],
  "leverage": 777,
  "TotalPositionSize": 77.70000000,
  "TotalProfits": 499.93591032,
  "equity": 577.63591032,
  "LastPrice": 5446.78896896,
  "LastHeight": 4324,
  "LiquidationPrice": 5395.10314405
}
```
Looks like no luck with rekt this time

[03-May-19 06:21 AM] dimxy#2587
I was able to rekt with negative leverage -777 for BTS_USD (at it was growing  yesterday)

[03-May-19 06:26 AM] TonyL#3577
It looks like I'm super lucky because my costbasis is 5402 and LiquidationPrice just 7 dollars beyond

[03-May-19 06:27 AM] TonyL#3577
It's just a miracle to not touch this mark

[03-May-19 06:40 AM] dimxy#2587
for leverage 777 it is okay, isn't it?

[03-May-19 06:57 AM] TonyL#3577
This spread between costbasis and LiquidationPrice is fine for sure

[03-May-19 07:02 AM] TonyL#3577
Just in average somewhere around 776 bets from 777 should be rekt 😂

[03-May-19 09:29 AM] TonyL#3577
@dimxy Tried simple multistack synthetic price: https://paste.ubuntu.com/p/TSVJbpv59Z/ (I just copypasted same stack 8 times)
Expected ~400k * 8 (400k + 400k + 400k ...) but it looks like price calculated as one stack price only

[03-May-19 09:32 AM] dimxy#2587
okay, checking...

[03-May-19 09:40 AM] dimxy#2587
I believe this is by design  as synthetic  price is actually a weighed  index: 
```(price1 * weight1  + price2* weight2 +...) / (weight1+weight2+...)```

[03-May-19 09:48 AM] TonyL#3577
1*A + 1*A + 1*A + 1*A + 1*A + 1*A + 1*A + 1*A = 8*A  I wonder

[03-May-19 09:49 AM] TonyL#3577
Ah if indexes normalized on 1 each is 1/8

[03-May-19 09:49 AM] jl777c#5810
8*A/8

[03-May-19 09:50 AM] TonyL#3577
My bad, sry

[03-May-19 09:50 AM] TonyL#3577
So it seems to work correct 😃

[07-May-19 07:11 AM] dimxy#2587
Now we need to implement  some risk management strategy to prevent bankruptcy.
Do we have a technique in mind?
should we for example calculate probabilistic data, like expected values to take into account?

[07-May-19 07:24 AM] TonyL#3577
I think for now we can take some number just from head and then calibrate (start from assumtion that on range contract "playing" 50/50 with players) and not accept bet if winnings exceed 1% of CC bankroll

[07-May-19 07:24 AM] TonyL#3577
Also not accept new bets maybe if active ones cannot be settled with current bankroll and such assumption

[07-May-19 07:26 AM] TonyL#3577
So in case of 50/50 desired formula is `bet_expected_value = bet_amount * loss_probability + bet_amount * won_probability = bet_amount * 0.5 + bet_amount * 0.5 = bet_amount`

[07-May-19 07:28 AM] TonyL#3577
But not sure how it's possible to prevent creation of 100 same bets of 1% in same block

[07-May-19 07:30 AM] TonyL#3577
Maybe more cunning mechanism is needed - like a deviding/spread of CC bankroll between different markets 
Lets say 25% of CC bankroll can be used on cryptomarkets bets only, 25% on forex pairs, 25% on stocks, 25% on combined - something like that

[07-May-19 07:35 AM] TonyL#3577
Player with enough bankroll can drain now whole CC bankroll by one bet if he is lucky enough (or have some additional insider information / advantage over the house)
Thinking on very hypotetical situations when in CC bankroll few million USD lets say and to manipulate market 10000 USD needed for example

[07-May-19 07:35 AM] TonyL#3577
So one such "attack" on some low liquidity pair will drain whole bankroll

[07-May-19 07:36 AM] jl777c#5810
it seems needed to only allow betting on high liquidity pairs

