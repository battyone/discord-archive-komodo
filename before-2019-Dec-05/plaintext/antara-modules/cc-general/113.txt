==============================================================
Guild: Komodo
Channel: cc-general
Topic: Dev Docs: https://developers.komodoplatform.com | Test plan: https://docs.google.com/spreadsheets/d/1l0dWEPcrv9zE11_TD-XrX_HIYV0VLpadCJN6hvaZERc/edit#gid=211514340
https://medium.com/@jameslee777/how-to-implement-finite-state-machines-into-a-cc-8dfeadccbcad
https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC
Messages: 100
Range: before 05-Dec-19 12:00 AM
==============================================================

[09-Oct-18 05:26 PM] jl777c#5810
so we need to have it in the opreturn

[09-Oct-18 05:26 PM] jl777c#5810
dont want to get forks due to different results from runtime js

[09-Oct-18 05:27 PM] radix42#3743
Where I am going is that at that point you are shipping a JavaScript interpreter with full nodes, so you could do things like run js-ipfs and stick data in there

[09-Oct-18 05:28 PM] radix42#3743
be able to have contracts at an ipfs hash

[09-Oct-18 05:28 PM] jl777c#5810
certainly an ipfs CC is a good thing to have

[09-Oct-18 05:29 PM] jl777c#5810
but not sure it is safe to have contracts at an ipfs hash

[09-Oct-18 05:29 PM] jl777c#5810
what if it is there at one point in time and not there later, seems a fork

[09-Oct-18 05:29 PM] jl777c#5810
i lean toward fully compiled methods

[09-Oct-18 05:30 PM] radix42#3743
8k is so tiny tho!

[09-Oct-18 05:30 PM] blackjok3r#3181
need to be smarter

[09-Oct-18 05:31 PM] radix42#3743
Lord these arm builds take forever

[09-Oct-18 05:32 PM] jl777c#5810
8kb for a single function?

[09-Oct-18 05:32 PM] jl777c#5810
how many functions are so big?

[09-Oct-18 05:33 PM] radix42#3743
Point!

[09-Oct-18 05:33 PM] jl777c#5810
this will force small functions

[09-Oct-18 05:34 PM] jl777c#5810
which then create a blockchain wide library

[09-Oct-18 05:34 PM] jl777c#5810
it seems a good gain for what is sacrificed (large spagetti functions that really should be decomposed into smaller ones)

[09-Oct-18 05:34 PM] jl777c#5810
the on thing that maybe will be restrictive is large data tables

[09-Oct-18 05:53 PM] radix42#3743
Ya

[09-Oct-18 06:03 PM] jl777c#5810
but there are ways around that

[09-Oct-18 07:10 PM] radix42#3743
W00t I‚Äôve got an arm64 build of jl777/dev

[09-Oct-18 07:11 PM] radix42#3743
Just fired it up to sync

[09-Oct-18 07:13 PM] radix42#3743

{Attachments}
https://cdn.discordapp.com/attachments/466507187842187264/499298483048677395/image0.jpg

{Reactions}
üéÜ (3) shexy (6) 

[09-Oct-18 08:22 PM] radix42#3743
At 85% sync now, the node was already synced to June

[09-Oct-18 08:24 PM] radix42#3743
It‚Äôs using 2.5 gigs of resident memory, @grewalsatinder, so it really wants a beefy aarch64 machine

[09-Oct-18 09:25 PM] radix42#3743
This is the branch: https://github.com/MercerWeissAlt/komodo/tree/dev-aarch64
I need to update the README with the weird symlinks you need to make for it to build

{Embed}
https://github.com/MercerWeissAlt/komodo/tree/dev-aarch64
MercerWeissAlt/komodo
zcash. Contribute to MercerWeissAlt/komodo development by creating an account on GitHub.
https://avatars3.githubusercontent.com/u/25749108?s=400&v=4

[09-Oct-18 09:26 PM] jl777c#5810
can you make a pull request to dev branch?

[09-Oct-18 11:00 PM] radix42#3743
yeah, I'll add to the README first tho

[09-Oct-18 11:02 PM] radix42#3743
the bit that you thought made it unmergeable in January is I think NOT an issue, as it merely removes a conditional requiring it to be amd64, when really the code in question builds on any 64 bit proc......I'll try a build of the branch that builds on arm64 on Intel/amd to verify that before I make a PR

[09-Oct-18 11:03 PM] radix42#3743
I'll kick that off on my Xeon build server rn

[09-Oct-18 11:07 PM] radix42#3743
(ok any little endian 64 bit platform *sigh*)

[09-Oct-18 11:09 PM] radix42#3743
I'll also add the 3 commands you need to run to install and setup mingw64 when cross compiling from lin->win, that's just kinda hand-waved üòÉ

[09-Oct-18 11:54 PM] radix42#3743
aaaarrrgghhhhh I need to add a platform conditional in depends/packages/packages.mk for it to all be in one branch......I'm about wiped for the day so later tonight or tomorrow I'll get all the above and THEN a PR!

[10-Oct-18 05:20 AM] dukeleto#7326
awesome progress in the backlog I just read üòÉ

{Reactions}
üëç 

[10-Oct-18 08:35 AM] TonyL#3577
Some teaser üòÉ

{Attachments}
https://cdn.discordapp.com/attachments/466507187842187264/499500186834567188/unknown.png

{Reactions}
ü§ë (4) üòá (4) üëç (6) üòé (3) 

[10-Oct-18 08:45 AM] Mylo#8306
in case you didn't know @TonyL , barterdex gui has a portfolio management function where you can set trades up so that if you had 33/33/34% of coins at the start and your target is 25/25/50% it will automatically do it.
First it was done by command line.
Then it was done to GUI.
And now with another version of GUI coming.
So your TUI will become GUI soon enough.
Awesome work!

I heard ca3 on a youtube interview talking about the text portfolio management in the background whilst i was doing other work.   it caught my attention, and then i joined the komodo slack.  and the rest is history...

[10-Oct-18 08:46 AM] TonyL#3577
Wow, automatical rebalancing?

[10-Oct-18 08:46 AM] Mylo#8306
haha yes you didn't know that was a feature.  yes, kmd has some interesting tech!!

{Reactions}
üôÄ 

[10-Oct-18 08:46 AM] Mylo#8306
BOTS

[10-Oct-18 08:48 AM] TonyL#3577
Wow that's cool

[10-Oct-18 08:51 AM] TonyL#3577
@Mylo That's why I want to participate actively in #cc-gui - TUI have to be scaled to GUI üòÉ

{Reactions}
üëç (3) Komodo (4) 

[10-Oct-18 11:45 AM] CrisF#3405
@TonyL @Mylo ,  @smk762 -  dracocanis ominator made a balancing script for `coinmigration` in #kmdlabs .

[10-Oct-18 11:46 AM] CrisF#3405
It could equalize coins between chains.  Very cool.

[10-Oct-18 01:14 PM] gcharang#6833
When is the `rewardsaddress` RPC useful?

[10-Oct-18 01:22 PM] jl777c#5810
when you want to know what addreses the rewards CC uses

[10-Oct-18 01:49 PM] dukeleto#7326
that TUI screenshot above is pretty awesome, we have come a long way

{Reactions}
üëç (3) 

[10-Oct-18 01:49 PM] dukeleto#7326
harkens back to text adventures and BBS'es

[10-Oct-18 01:50 PM] dukeleto#7326
Crypto-Conditions Text Adventure, with ascii art, could be the next cryptokittiez

{Reactions}
Komodo 

[10-Oct-18 02:54 PM] gcharang#6833
As far as I can tell, the address ``rewards CC`` uses for a user is calculated based on his pubkey and the eval code for rewards CC.
And  this is the address to which his locked vout for the reward go.

When I do the RPC call, I get:

```
./komodo-cli -ac_name=CCNG rewardsaddress 03810d28146f60a42090991b044fe630d1664f3f8f46286c61e7420523318047b5
{
  "result": "success",
  "RewardsCCaddress": "RTsRBYL1HSvMoE3qtBJkyiswdVaWkm8YTK",
  "Rewardsmarker": "RMgye9jeczNjQx9Uzq8no8pTLiCSwuHwkz",
  "GatewaysPubkey": "03ea9c062b9652d8eff34879b504eda0717895d27597aaeb60347d65eed96ccb40",
  "RewardsCCassets": "RLh5sgvh3scCyM4aq1fhYhwgfbmb5SpCkT",
  "CCaddress": "RJdwcBsoWwmt9dtSqyFCULNW2F3zj2mcD3",
  "myCCaddress": "RJdwcBsoWwmt9dtSqyFCULNW2F3zj2mcD3",
  "myaddress": "RVXhz5UCJfSRoTfa4zvBFBrpDBbqMM21He"
}
```

In the above json, 

* `myaddress` is the actual KMD address corresponding to the pubkey
* `RewardsCCaddress` is the Global address corresponding to rewards that has the privkey in the source
* `Rewardsmarker` is the normal address corresponding to the Global rewards address
* `myCCaddress` is the address generated based on pubkey of user and evalcode of rewards

May I know the diffrence between  `CCaddress` and `myCCaddress` ?

Also what are `RewardsCCassets` and `GatewaysPubkey` ?

[10-Oct-18 03:29 PM] Mylo#8306
@gcharang if you are making notes, here is the privkey you mention being in the src https://github.com/jl777/komodo/blob/jl777/src/cc/CCcustom.cpp#L87
I'm sorry i don't know the answers for your CCaddress/myCCaddress questions and would only be able to give bad guesses at this stage.

{Embed}
https://github.com/jl777/komodo/blob/jl777/src/cc/CCcustom.cpp
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://avatars2.githubusercontent.com/u/5962559?s=400&v=4

[10-Oct-18 04:25 PM] gcharang#6833
Thanks @Mylo I did go through the file you linked and the comments in it and some of the others. I am also documenting these RPC

[10-Oct-18 10:48 PM] Kalyan#1867
Hello Everyone, I am Kalyan Sikdar, graduate student in University of Texas, Arlington. I am new to this group and have been invited by Dr. Sajib Dutta. Thank you for having me here.

{Reactions}
üëã (8) Komodo (4) 

[11-Oct-18 03:53 AM] dukeleto#7326
@Kalyan welcome

[11-Oct-18 05:47 AM] SuSC135#6248
Hello , Dr Datta from invited me to join this channel.
I am very much interested in block chains and have been exploring few uses cases from  past one year. Komodo has really interesting concepts and I am really looking forward to work on it.  Right now I am just going through the github link . Let's see where it takes me

{Reactions}
Komodo (3) 

[11-Oct-18 06:46 AM] actionslacks#4072
Welcome @SuSC135

[11-Oct-18 09:25 AM] TonyL#3577
@Mihailo I can't do `channelsclose` for new channel without any `channelspayment` done:
`channelsclose fb1a5808955dad43579e09992f2f8be24dc6db37721a451f462e3151a9115498`
```CC Eval EVAL_CHANNELS Invalid: channelOpen is not yet confirmed(notarised)! spending tx fb1a5808955dad43579e09992f2f8be24dc6db37721a451f462e3151a9115498
error code: -26
error message:
16: mandatory-script-verify-flag-failed (Script evaluated without error but finished with a false/empty top stack element)```
`channelsopen` transaction is mined. 

As soon as I broadcast one `channelspayment` even if it in mempool I can close the channel.

So if I'm changed my mind to use this channel there is no way to close it without at least one `channelspayment`
Is it by design?

[11-Oct-18 09:27 AM] Mihailo#5902
@TonyL Let me take a look. Did you mine 2 blocks after open tx? I set minimum confirmations to 2 just for now.

[11-Oct-18 09:28 AM] TonyL#3577
@Mihailo Let me try again with ensuring that at least 2 blocks are mining after `channelsopen`

[11-Oct-18 09:28 AM] Mihailo#5902
you can use "getrawtransaction txid 1" to se number of confirmations on tx

[11-Oct-18 09:29 AM] TonyL#3577
Yup, just have to open new channel now because closed previous one after `channelspayment`

[11-Oct-18 09:37 AM] TonyL#3577
@Mihailo `"confirmations": 2` but still same error after `channelsclose`
And after `channelspayment` I'm able to `channelsclose`

[11-Oct-18 09:37 AM] Mihailo#5902
Ok, I'll check it right away

[11-Oct-18 09:45 AM] Mihailo#5902
Hmmm, I have done channelopen, waited for 2 confirmation and then done channelclose with success

[11-Oct-18 09:46 AM] Mihailo#5902
Without payment

[11-Oct-18 09:46 AM] Mihailo#5902
```
{
  "result": "success",
  "name": "Channel RRPDp9nQCgW7EGvyw9RtQV7eJZiNXrzzbB",
  "Open": "10 payments of 100000 satoshi",
  "Close": "channel"
}
```

[11-Oct-18 09:52 AM] TonyL#3577
```./komodo-cli -ac_name=CCNG channelsopen 0324f94e76159d69a5163b91588c3a04dac2c80e0011f713e3bfc5a8b67ba01272 10 1000000```
``` ./komodo-cli -ac_name=CCNG sendrawtransaction hex <- 7e950f191111c352cd74611d37c3b6d553c8f6c3e9b5089a402a11310785faa5```
```./komodo-cli -ac_name=CCNG getrawtransaction 7e950f191111c352cd74611d37c3b6d553c8f6c3e9b5089a402a11310785faa5 1 <-  "confirmations": 2
```

[11-Oct-18 09:52 AM] TonyL#3577
```./komodo-cli -ac_name=CCNG channelsclose 7e950f191111c352cd74611d37c3b6d553c8f6c3e9b5089a402a11310785faa5
{
  "result": "success",
  "hex": "0100000003a5fa850731112a409a08b5e9c3f6c853d5b6c3371d6174cd52c31111190f957e0300000049483045022100ca5cea7f97401fa3ad6cdb4c3e4da29be1d925562d74a1f6af8f2fbb3358207a02203bbf74601c037683722e4954771b248afed06a328ed469227d7cf818a9d9f53301ffffffffa5fa850731112a409a08b5e9c3f6c853d5b6c3371d6174cd52c31111190f957e00000000a74ca5a281a1a0819ca28194a067a56580210283657a59d69386db4785c48cc8762ebd9113c272fd02d4aed0a172516e7fdc5d81401f1187dca11f9f48ad51bbe2ab64d1b312a47d6a6c6e6259533ed227f346260d74fe267c34483da13312cd7fa18ddf162936e0c2aeb680be75cf05719f08dcc1a129a5278020a033e38f682061a23636f0144ecebb9fcb8c4bddc8e7e3101c0f5b7a2e3d13b48103020000af038001eba10001ffffffffa5fa850731112a409a08b5e9c3f6c853d5b6c3371d6174cd52c31111190f957e010000007b4c79a276a072a26ba067a56580210283657a59d69386db4785c48cc8762ebd9113c272fd02d4aed0a172516e7fdc5d814029090aecebcf0604255e114ca63948843b3e293295fb5a7b13cda03a63a9d3df358b6a99cc6c0cf282b9676a6282852d3e7492a36a86103b30c3a742f0d59332a100af038001eba10001ffffffff058096980000000000302ea22c80206033530bc76b649680a856d002cfc8fb2ffff134249a8d8f3996e79d37230da681031210008203000401cc1027000000000000302ea22c8020b51867c95ca6c53d2427c935318e7ef3b0c10aae9c9643a4aaad3f8cd703f2ae8103120c008203000401cc1027000000000000302ea22c8020c9ada2adfc6c6dec0bd9dd29f4e48c86f84c016abc3552b8815ca3c4a44c561b8103120c008203000401ccc657df5b7400000023210283657a59d69386db4785c48cc8762ebd9113c272fd02d4aed0a172516e7fdc5dac0000000000000000956a4c92eb43a5fa850731112a409a08b5e9c3f6c853d5b6c3371d6174cd52c31111190f957e210283657a59d69386db4785c48cc8762ebd9113c272fd02d4aed0a172516e7fdc5d210324f94e76159d69a5163b91588c3a04dac2c80e0011f713e3bfc5a8b67ba012720a00000040420f0000000000000000000000000000000000000000000000000000000000000000000000000000000000"
}
```

[11-Oct-18 09:52 AM] TonyL#3577
```./komodo-cli -ac_name=CCNG sendrawtransaction hex^^
anon fingerprint 0x106a68e10 0x106a6f658
anon fingerprint 0x106a68700 0x106a72a38
CC Eval EVAL_CHANNELS Invalid: channelOpen is not yet confirmed(notarised)! spending tx 7e950f191111c352cd74611d37c3b6d553c8f6c3e9b5089a402a11310785faa5
error code: -26
error message:
16: mandatory-script-verify-flag-failed (Script evaluated without error but finished with a false/empty top stack element)```

[11-Oct-18 09:53 AM] TonyL#3577
Just tried one more time hmm. I'm on latest FSM. Maybe it's connected to particular AC specifics

[11-Oct-18 09:55 AM] TonyL#3577
Waited a little bit more and it's closed

[11-Oct-18 09:55 AM] TonyL#3577
@Alright Is CCNG notarizing?

[11-Oct-18 09:56 AM] Mihailo#5902
It does not have to be notarised as for now just checking confirmations. Check for notarisation has yet to be done.

[11-Oct-18 09:56 AM] TonyL#3577
Oh I see

[11-Oct-18 09:57 AM] TonyL#3577
Btw I can execute one more `channelsclose` transaction for the same channel even if previous `channelclose` mined

[11-Oct-18 09:57 AM] TonyL#3577
```./komodo-cli -ac_name=CCNG channelsinfo 7e950f191111c352cd74611d37c3b6d553c8f6c3e9b5089a402a11310785faa5
{
  "result": "success",
  "name": "Channel RRyrN2G7fRqxdbFcWqxh5PYPR1scCXQEFP",
  "Open": "10 payments of 1000000 satoshi",
  "Close": "channel",
  "Close": "channel"
}
```

[11-Oct-18 09:58 AM] TonyL#3577
And it's double closed now

[11-Oct-18 09:58 AM] Mihailo#5902
Ok, I`ve been able to reproduce

[11-Oct-18 09:59 AM] TonyL#3577
@Mihailo Situation when not possible to broadcast `channelsclose` for some time with `error code: -26`?

[11-Oct-18 10:00 AM] Mihailo#5902
Yes

[11-Oct-18 10:02 AM] TonyL#3577
Just wondering: maybe it's better to have "State" parameter with `Open` or `Close` states 
Or Open parameter with true/false. So if it's closed RPC not allows to send one more closing transaction

[11-Oct-18 10:03 AM] Mihailo#5902
Yeah, I was just thinking that too. RPC needs to check for state and not allow to close already closed, and not opened channel ...

[11-Oct-18 10:06 AM] TonyL#3577
It will help to build dAPP a lot as well.
For example now for `Channel closing` feature I want to display all opened channels by user but it's quite problematic to get such list. 
Only way is parse all `channelsinfo` then from "name" I have to parse only wallet, then for this wallet I have to execute `validateaddress`, then parse and check is it mine

[11-Oct-18 10:08 AM] Mihailo#5902
Ok, found what is the problem. getrawtransaction is returning confirmations 2 but function that checks confirmations return 1. The thing is that the tx ended in block 52 in my case and now it is block 53. Function that calculate confirmations does current height - tx height which is 1, but getrawtransaction returns 2 confirmations....

[11-Oct-18 10:09 AM] TonyL#3577
Oh so actually it should work when `getrawtransaction` returning confirmations 3

[11-Oct-18 10:09 AM] Mihailo#5902
yep

[11-Oct-18 10:10 AM] Mihailo#5902
So I`m just thinking now, what is proper calculation. I think the first, 1 confirmation is one block after the tx....

[11-Oct-18 10:10 AM] Mihailo#5902
It seems that getrawtransaction is wrong üò±

[11-Oct-18 10:11 AM] TonyL#3577
Confirmations are blocks after block to which transaction included

[11-Oct-18 10:11 AM] TonyL#3577
In my understanding

[11-Oct-18 10:11 AM] TonyL#3577
`getrawtransaction` printing `confirmation: 1` right after transaction mined

[11-Oct-18 10:12 AM] TonyL#3577
üôÄ

[11-Oct-18 10:12 AM] Mihailo#5902
Yep

[11-Oct-18 10:18 AM] Mihailo#5902
@jl777c Is this bug or intended to be like this?

[11-Oct-18 11:31 AM] TonyL#3577
@Mihailo Seems here same  2 confirmations checking for `channelsclose` transaction when doing `channelsrefund`

[11-Oct-18 11:33 AM] TonyL#3577
https://github.com/tonymorony/cryptoconditions_tui/blob/master/channels_cc_cli.py first alpha release for channelsCC TUI üòÉ . This time handling much more exceptions than in GatewaysCC TUI so should crash less

{Embed}
https://github.com/tonymorony/cryptoconditions_tui/blob/master/channels_cc_cli.py
tonymorony/cryptoconditions_tui
Terminal user interfaces for Komodo CryptoConditions smart-contracts - tonymorony/cryptoconditions_tui
https://avatars1.githubusercontent.com/u/24797699?s=400&v=4

[11-Oct-18 11:45 AM] Mylo#8306
```
jl777cLast Friday at 2:03 PM
right now the notarization check is a stub
but once a channel is created, it is a matter of making a payment
system is backwards compatible with wallets, explorers, etc. nothing special to setup
though we would want a GUI that can indicate when the mempool payment arrives
so right now, you should be able to break the payment with a reorg
but it is a matter to then add notarization and notarization check, then that makes it dPoW protected mempool payment
```

[11-Oct-18 11:45 AM] Mylo#8306
stub = https://en.wikipedia.org/wiki/Method_stub

{Embed}
https://en.wikipedia.org/wiki/Method_stub
Method stub
A method stub or simply stub in software development is a piece of code used to stand in for some other programming functionality. A stub may simulate the behavior of existing code (such as a procedure on a remote machine, such methods are often called mocks) or be a temporar...

[11-Oct-18 11:46 AM] Mylo#8306
from #kmdlabs üëÜ

{Reactions}
üëç 

[11-Oct-18 11:46 AM] Mylo#8306
@Mihailo @TonyL

[11-Oct-18 11:49 AM] TonyL#3577
Hmm will think on mempool scan implementation

