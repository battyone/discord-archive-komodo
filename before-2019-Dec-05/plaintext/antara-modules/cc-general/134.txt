==============================================================
Guild: Komodo
Channel: cc-general
Topic: Dev Docs: https://developers.komodoplatform.com | Test plan: https://docs.google.com/spreadsheets/d/1l0dWEPcrv9zE11_TD-XrX_HIYV0VLpadCJN6hvaZERc/edit#gid=211514340
https://medium.com/@jameslee777/how-to-implement-finite-state-machines-into-a-cc-8dfeadccbcad
https://github.com/dimxy/komodo/wiki/Designing-RPC-for-FSM-CC
Messages: 100
Range: before 05-Dec-19 12:00 AM
==============================================================

[28-Nov-18 10:47 AM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST2 getrawtransaction 8b23f96695fc36cd1556c7c85a09c52e547bdc71c602da185cb1e1b4be1f5bad 1
{
  "hex": "0400008085202f890101989416af9b13eda12e11e40467c0f86908ec570b2f1df30d24f3eb11973f600000000049483045022100b01c0e57c8cff9a9f6c0451757d06b4765efffd9fab22352b986d8dfe474c12f02205f155cb1d6197cfcaff9062f865f3eb6dd188256fa08f70d412fe1bd342ba5fa01ffffffff0200e8764817000000302ea22c8020e029c511da55523565835887e412e5a0c9b920801b007000df45e545f25028248103120c008203000401ccf090fb0501090000232103a52c3fc715c4e87fb80427e97c1f5c328e57ea64d1a7a3e1f442ed1a728b40f3ac000000006f0000000000000000000000000000",
  "txid": "8b23f96695fc36cd1556c7c85a09c52e547bdc71c602da185cb1e1b4be1f5bad",
  "overwintered": true,
  "version": 4,```

[28-Nov-18 10:51 AM] TonyL#3577
@SHossain @siu - Chainmakers @Alright If you have time - could you please help re-test all CCs basic RPC calls according to the test plan on latest FSM with ` komodo_defs.h` from pirate repo?
I've started fresh chain:  ```./komodod -ac_name=SPLTEST2 -ac_supply=5555555 -ac_reward=10000000000000 -ac_cc=2 -addressindex=1 -spentindex=1 -addnode=159.69.201.122 -addnode=159.69.45.70 --daemon```

[28-Nov-18 11:25 AM] KNOX#9338
FSM branch updated in PirateNetwork repo

[28-Nov-18 12:52 PM] siu - Chainmakers#3920
morning! will test now

{Reactions}
üëçüèΩ 

[28-Nov-18 01:01 PM] SHossain#0007
i'm using the original SPLTEST chain

[28-Nov-18 01:15 PM] siu - Chainmakers#3920
we need a new chain?

[28-Nov-18 01:25 PM] SHossain#0007
@siu - Chainmakers check the first pinned post of this channel. instructions were posted by @KNOX

[28-Nov-18 01:25 PM] siu - Chainmakers#3920
yes, im using SPLTEST

[28-Nov-18 01:25 PM] siu - Chainmakers#3920
i was asking since i see there is a SPLTEST2

[28-Nov-18 01:25 PM] SHossain#0007
We need to follow those instructions to compile and start the chain to test CC

[28-Nov-18 01:25 PM] SHossain#0007
i don't think we need SPLTEST2

[28-Nov-18 01:26 PM] SHossain#0007
Tony created that while the source wasn't updated in the PN repo.

[28-Nov-18 01:26 PM] SHossain#0007
he is currently busy with something and will be back soon

[28-Nov-18 01:26 PM] siu - Chainmakers#3920
```./komodo-cli -ac_name=SPLTEST sendrawtransaction 0400008085202f89012a488121f84959aca4b946ac51a07a7a90c3e24ed7a09beee6ce45161599244c000000004948304502210090f3b79a7eefa5bbdbb4ed7f77f8a3a2e886f2b840dcd4a6cfaa5f9bd8880000022004956cdf4c32faf2e095edc9cdeef870871a3bd3549be98836019b2f928c0fbf01ffffffff0500e40b5402000000302ea22c80200095ece5eee67e1f313e7ba2d156c7617106cd52b75c93ed3fb110ff3fba6e998103120c008203000401cc10270000000000002321024fa9afae455ace14d3c1373341b9eb0dd1b2a59ae073f45d28f9d129d6e97774ac10270000000000002321039d966927cfdadab3ee6c56da63c21f17ea753dde4b3dfd41487103e24b27e94eacd04666fa150900002321024fa9afae455ace14d3c1373341b9eb0dd1b2a59ae073f45d28f9d129d6e97774ac00000000000000002c6a2ae646544553540000000040420f000000000080969800000000000a000000000000001400000000000000000000001b0c00000000000000000000000000
74b7ba1eac1d7d75b51e770c3ec6413b4e0a289183ea1c572fb431492a0bcb5d
```

[28-Nov-18 01:26 PM] siu - Chainmakers#3920
`sendrawtransaction` seems to be working now

{Reactions}
üéâ 

[28-Nov-18 01:26 PM] SHossain#0007
jl777 fixed the tx version issue last night. we confirmed

[28-Nov-18 01:27 PM] SHossain#0007
other things been fixed this morning

[28-Nov-18 01:28 PM] siu - Chainmakers#3920
cool!

[28-Nov-18 01:29 PM] jl777c#5810
my assumption is that things work as well as they ever had now, just with sapling

[28-Nov-18 01:32 PM] jl777c#5810
if anything is behaving strange, plz report

[28-Nov-18 01:33 PM] siu - Chainmakers#3920
ok

[28-Nov-18 01:41 PM] SHossain#0007
i'll prepare the mightly insomnia now

[28-Nov-18 01:41 PM] siu - Chainmakers#3920
you have the file?

[28-Nov-18 01:42 PM] siu - Chainmakers#3920
for insomnia rpc calls?

[28-Nov-18 01:42 PM] SHossain#0007
i should have it backed up somewhere. but, if you can upload a new one, that would be great

[28-Nov-18 01:43 PM] SHossain#0007
yes, i have it and found

[28-Nov-18 01:43 PM] SHossain#0007
importing them now

[28-Nov-18 01:49 PM] SHossain#0007
reward cc tx is version 4

[28-Nov-18 01:49 PM] SHossain#0007
```
{
  "result": {
    "txid": "c7c36c2689091103ab50e46967df354dfa63de41af4ed9c71accb96895801791",
    "overwintered": true,
    "version": 4,
    "versiongroupid": "892f2085",
    "locktime": 0,
    "expiryheight": 3122,
```

[28-Nov-18 01:51 PM] SHossain#0007
@siu - Chainmakers here is the explorer if you need http://spltest.explorer.dexstats.info/

{Embed}
http://spltest.explorer.dexstats.info/
Komodo Explorer
Komodo Insight. View detailed information on all komodo transactions and block. {{ $root.title + $root.titleDetail }}

[28-Nov-18 01:54 PM] SHossain#0007
`rewardsaddfunding` is good

[28-Nov-18 01:57 PM] SHossain#0007
tested all rewards cc calls (except `rewardsunlock`) and all seems to be working fine

[28-Nov-18 02:04 PM] siu - Chainmakers#3920
```./komodo-cli -ac_name=SPLTEST dicebet TEST 74b7ba1eac1d7d75b51e770c3ec6413b4e0a289183ea1c572fb431492a0bcb5d 0.05 2
skip coinbase or strange entropy tx
skip coinbase or strange entropy tx
pendingbets.0 numentropy tx 2: 120.00000000
{
  "result": "error",
  "error": "cant find dice entropy inputs"
}
```

[28-Nov-18 02:04 PM] siu - Chainmakers#3920
`dicebet` is outputting this.

[28-Nov-18 02:05 PM] siu - Chainmakers#3920
i did 100 dicefund then did 2 entropy txs of 10 each.

[28-Nov-18 02:06 PM] siu - Chainmakers#3920
i guess it doesnt have anything to do with sapling, but 3 txs should be enough, or not?

[28-Nov-18 02:07 PM] TonyL#3577
There >= 100 `diceaddfunds` entropy transactions should be executed before do `dicebet`

[28-Nov-18 02:07 PM] SHossain#0007
have minimum of 10-20 entropy tx for testing

[28-Nov-18 02:07 PM] siu - Chainmakers#3920
ah

[28-Nov-18 02:07 PM] TonyL#3577
@SHossain there is kinda strict limit on 100 entropy TX atm

{Reactions}
üëçüèΩ 

[28-Nov-18 02:08 PM] siu - Chainmakers#3920
right, these where the changes done by jl777 for KMDICE

[28-Nov-18 02:08 PM] siu - Chainmakers#3920
that is a pain to do manually hehehe, let me get the script

[28-Nov-18 02:08 PM] jl777c#5810
its not consensus level, but rpc, so can be bypassed

[28-Nov-18 02:08 PM] blackjok3r#3181
the 100 min was something I added as a work around before jl made all the changes

[28-Nov-18 02:08 PM] blackjok3r#3181
it cna probaly be lowerd a lot

[28-Nov-18 02:09 PM] blackjok3r#3181
if not removed

[28-Nov-18 02:10 PM] blackjok3r#3181
its to stop multiple people choosing the same entropy tx.. or alt least reduce the chance of it happening.

[28-Nov-18 02:10 PM] SHossain#0007
`tokencreate` generated version 4 tx

[28-Nov-18 02:11 PM] siu - Chainmakers#3920
ok, sending the entropy txs now

[28-Nov-18 02:13 PM] SHossain#0007
`tokenlist` and `tokeninfo` working as usual
```
{
  "result": {
    "result": "success",
    "tokenid": "5b15d1d283f0f74efc1a246e672ecb44a1309b134677e484a374bc001c7729c9",
    "owner": "02fdc75bb1846234c0bd49d75e47b62e67fa582256c286f1e9ee750ac2c1ba313e",
    "name": "SPL",
    "supply": 100000000,
    "description": "Sapling Token Test"
  },
  "error": null,
  "id": null
}
```

[28-Nov-18 02:16 PM] SHossain#0007
`diceinfo`
```
{
  "result": {
    "result": "success",
    "fundingtxid": "74b7ba1eac1d7d75b51e770c3ec6413b4e0a289183ea1c572fb431492a0bcb5d",
    "name": "TEST",
    "sbits": 1414743380,
    "minbet": "0.01000000",
    "maxbet": "0.10000000",
    "maxodds": 10,
    "timeoutblocks": 20,
    "funding": "121.70000000",
    "entropytxs": 10
  },
  "error": null,
  "id": null
}
```

[28-Nov-18 02:16 PM] SHossain#0007
`dicebet` 
```
["TEST","74b7ba1eac1d7d75b51e770c3ec6413b4e0a289183ea1c572fb431492a0bcb5d","0.1", "2" ]
```

[28-Nov-18 02:16 PM] SHossain#0007
i get reply
```{
  "result": {
    "result": "error",
    "error": "Your dealer is broke, find a new casino."
  },
  "error": null,
  "id": null
}
```

[28-Nov-18 02:24 PM] TonyL#3577
Such error usually throwing when there is < 100 entropy txs

[28-Nov-18 02:25 PM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST2 diceinfo b0865b83755daa54e3c1d47163691677ec60d058183f3334b7abcd3bc3f7d09d
skip coinbase or strange entropy tx
skip coinbase or strange entropy tx
skip coinbase or strange entropy tx
pendingbets.0 numentropy tx 210: 31000.00000000
{
  "result": "success",
  "fundingtxid": "b0865b83755daa54e3c1d47163691677ec60d058183f3334b7abcd3bc3f7d09d",
  "name": "TONY",
  "sbits": 1498304340,
  "minbet": "1.00000000",
  "maxbet": "100.00000000",
  "maxodds": 100,
  "timeoutblocks": 5,
  "funding": "31000.00000000",
  "entropytxs": 210
}
```

[28-Nov-18 02:25 PM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST2 dicebet TONY b0865b83755daa54e3c1d47163691677ec60d058183f3334b7abcd3bc3f7d09d 10 2
skip coinbase or strange entropy tx
skip coinbase or strange entropy tx
skip coinbase or strange entropy tx
pendingbets.0 numentropy tx 210: 31000.00000000
chosen entropy on loop: 40
{
  "result": "success",
  "hex": "0400008085202f890231de820fb361e5e4af797d55e44fde99d098da722175f4a3d8f55af62bf71113000000007b4c79a276a072a26ba067a5658021039d966927cfdadab3ee6c56da63c21f17ea753dde4b3dfd41487103e24b27e94e8140c9826664b3c590433de4c82869a5a8be29dcc1122c74ba63e81bb685904193703ea20697b23dce66dd9d7e29e2a9c7a902eb7351c992be2d187869715ebae66ea100af038001e6a10001ffffffff118b793617ac36d15099d3df5c561bd290c03ad1713ab41d12136fdb31b78db60000000049483045022100e37d564fd6557c2d02500a43501c3402dffe68b42c3dda0a5f2f64201d0cd41c022051153a0205c2cd5cef343255e25046b3d51fc0e19b205fe2d0d53a451ceeac2301ffffffff0500e40b5402000000302ea22c80200095ece5eee67e1f313e7ba2d156c7617106cd52b75c93ed3fb110ff3fba6e998103120c008203000401cc00ca9a3b00000000302ea22c80200095ece5eee67e1f313e7ba2d156c7617106cd52b75c93ed3fb110ff3fba6e998103120c008203000401cc1227000000000000232103a52c3fc715c4e87fb80427e97c1f5c328e57ea64d1a7a3e1f442ed1a728b40f3acde87d71218090000232103a52c3fc715c4e87fb80427e97c1f5c328e57ea64d1a7a3e1f442ed1a728b40f3ac00000000000000006d6a4c6ae642544f4e59000000009dd0f7c33bcdabb734333f1858d060ec7716696371d4c1e354aa5d75835b86b018e1d3f7c0a501168b7629dd6ece6c56395adb3a3029222b8360b2927cc08fb0000000000000000000000000000000000000000000000000000000000000000000000000810100000000000000000000000000"
}
```

[28-Nov-18 02:26 PM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST2 sendrawtransaction 0400008085202f890231de820fb361e5e4af797d55e44fde99d098da722175f4a3d8f55af62bf71113000000007b4c79a276a072a26ba067a5658021039d966927cfdadab3ee6c56da63c21f17ea753dde4b3dfd41487103e24b27e94e8140c9826664b3c590433de4c82869a5a8be29dcc1122c74ba63e81bb685904193703ea20697b23dce66dd9d7e29e2a9c7a902eb7351c992be2d187869715ebae66ea100af038001e6a10001ffffffff118b793617ac36d15099d3df5c561bd290c03ad1713ab41d12136fdb31b78db60000000049483045022100e37d564fd6557c2d02500a43501c3402dffe68b42c3dda0a5f2f64201d0cd41c022051153a0205c2cd5cef343255e25046b3d51fc0e19b205fe2d0d53a451ceeac2301ffffffff0500e40b5402000000302ea22c80200095ece5eee67e1f313e7ba2d156c7617106cd52b75c93ed3fb110ff3fba6e998103120c008203000401cc00ca9a3b00000000302ea22c80200095ece5eee67e1f313e7ba2d156c7617106cd52b75c93ed3fb110ff3fba6e998103120c008203000401cc1227000000000000232103a52c3fc715c4e87fb80427e97c1f5c328e57ea64d1a7a3e1f442ed1a728b40f3acde87d71218090000232103a52c3fc715c4e87fb80427e97c1f5c328e57ea64d1a7a3e1f442ed1a728b40f3ac00000000000000006d6a4c6ae642544f4e59000000009dd0f7c33bcdabb734333f1858d060ec7716696371d4c1e354aa5d75835b86b018e1d3f7c0a501168b7629dd6ece6c56395adb3a3029222b8360b2927cc08fb0000000000000000000000000000000000000000000000000000000000000000000000000810100000000000000000000000000
d5c95ead928b5ea0e8e5853e67d083d3a8cc49efe5b1136cea131e4939141a6e
```

[28-Nov-18 02:28 PM] TonyL#3577
If someone need to make more entropy (just have to change -ac_name  and plan name/id): 
```#!/bin/bash
TXNUM=0
while [ $TXNUM -lt 105 ]; do
    hash=$(./komodo-cli -ac_name=SPLTEST2 diceaddfunds TONY b0865b83755daa54e3c1d47163691677ec60d058183f3334b7abcd3bc3f7d09d 100 | jq -r .hex)
    ./komodo-cli -ac_name=SPLTEST2 sendrawtransaction $hash >> txs.txt
    let TXNUM=TXNUM+1
done```

{Reactions}
üëèüèΩ 

[28-Nov-18 02:29 PM] SHossain#0007
play my dice, bigger bets, more to win :P
```
{
  "result": {
    "result": "success",
    "fundingtxid": "08733c9898250a04ee16a3f1ae6c712fe90ed274d48278896f8719462c0e1a50",
    "name": "SPL",
    "sbits": 5001299,
    "minbet": "10.00000000",
    "maxbet": "10000.00000000",
    "maxodds": 50,
    "timeoutblocks": 1,
    "funding": "398.00000000",
    "entropytxs": 2
  },
  "error": null,
  "id": null
}
```

[28-Nov-18 02:30 PM] TonyL#3577
Your casino seems broke üòÇ

[28-Nov-18 02:30 PM] SHossain#0007
really??

[28-Nov-18 02:30 PM] TonyL#3577
```"entropytxs": 2```

[28-Nov-18 02:30 PM] SHossain#0007
oh...rest of them are in mempool

[28-Nov-18 02:30 PM] SHossain#0007
mempool is quite big now

[28-Nov-18 02:30 PM] SHossain#0007
need to wait for the next block

[28-Nov-18 02:35 PM] SHossain#0007
@TonyL check now

[28-Nov-18 02:35 PM] SHossain#0007
11 entropy tx

[28-Nov-18 02:35 PM] SHossain#0007
not so broken? üòõ

[28-Nov-18 02:36 PM] SHossain#0007
actually, i'm getting broken

[28-Nov-18 02:36 PM] SHossain#0007
doh

[28-Nov-18 02:37 PM] SHossain#0007
dealer node shows
```
pendingbets.0 numentropy tx 11: 32458.00000000
chosen entropy on loop: 13
pendingbets.0 numentropy tx 11: 32458.00000000
```

[28-Nov-18 02:38 PM] SHossain#0007
@TonyL @siu - Chainmakers can you please confirm the SPL dicebet is broken?

[28-Nov-18 02:38 PM] SHossain#0007
`["SPL","08733c9898250a04ee16a3f1ae6c712fe90ed274d48278896f8719462c0e1a50","10", "2" ]`

[28-Nov-18 02:39 PM] TonyL#3577
Do you have 100+ entropy tx on it?

[28-Nov-18 02:39 PM] SHossain#0007
nope

[28-Nov-18 02:40 PM] SHossain#0007
under 15

[28-Nov-18 02:41 PM] siu - Chainmakers#3920
Im working on fundig my test plan with more than 100 txs

[28-Nov-18 02:44 PM] TonyL#3577
@siu - Chainmakers I've posted funding script example above, maybe it'll help

[28-Nov-18 02:45 PM] siu - Chainmakers#3920
I have a funding script, thanks :)

{Reactions}
üëå 

[28-Nov-18 02:48 PM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST dicebet SPL 08733c9898250a04ee16a3f1ae6c712fe90ed274d48278896f8719462c0e1a50 100 10
pendingbets.0 numentropy tx 14: 32458.30000000
{
  "result": "error",
  "error": "Your dealer is broke, find a new casino."
}
```
@SHossain Your dealer is broke - need to make more entropy txs

[28-Nov-18 02:49 PM] siu - Chainmakers#3920
Lol

[28-Nov-18 02:50 PM] SHossain#0007
aha...ok. will do

[28-Nov-18 02:52 PM] siu - Chainmakers#3920
```./komodo-cli -ac_name=SPLTEST dicestatus TEST 74b7ba1eac1d7d75b51e770c3ec6413b4e0a289183ea1c572fb431492a0bcb5d ff673f36a371dca051cb069656f400d53d9d2d858ab458b49fff8f22d31d5777
cc_verify error C
cc_verify error C
rebroadcast.L and clear [0] and broadcast entropyused.ac1c964ad583f48cefe68ef1d9ec1f49b8ce826e74bc6cf7fa9584513aed65ab bettxid.ff673f36a371dca051cb069656f400d53d9d2d858ab458b49fff8f22d31d5777 -> 7f60cfb75eece1487dae4cdb13698d2bacc5774efc62a4b7997224224c1c428b
error: couldn't connect to server: EOF reached (code 1)
(make sure server is running and you are connecting to the correct RPC port)
[1]+  Segmentation fault      (core dumped) ./komodod -ac_name=SPLTEST -ac_supply=5555555 -ac_reward=10000000000000 -ac_cc=2 -addressindex=1 -spentindex=1 -addnode=54.36.126.42 -addnode=94.130.224.11 -pubkey=024fa9afae455ace14d3c1373341b9eb0dd1b2a59ae073f45d28f9d129d6e97774
```

[28-Nov-18 02:52 PM] siu - Chainmakers#3920
dice status broke the node

[28-Nov-18 02:52 PM] siu - Chainmakers#3920
"core dumped"

[28-Nov-18 02:52 PM] siu - Chainmakers#3920
@jl777c

[28-Nov-18 02:53 PM] siu - Chainmakers#3920
```2018-11-28 14:52:12 ERROR: CScriptCheck(): 7f60cfb75eece1487dae4cdb13698d2bacc5774efc62a4b7997224224c1c428b:1 VerifySignature failed: Script evaluated without error but finished with a false/empty top stack element
2018-11-28 14:52:12 ERROR: CScriptCheck(): 7f60cfb75eece1487dae4cdb13698d2bacc5774efc62a4b7997224224c1c428b:1 VerifySignature failed: Script evaluated without error but finished with a false/empty top stack element
2018-11-28 14:52:12 ERROR: AcceptToMemoryPool: ConnectInputs failed 7f60cfb75eece1487dae4cdb13698d2bacc5774efc62a4b7997224224c1c428b
```

[28-Nov-18 02:54 PM] siu - Chainmakers#3920
debug.log ^

[28-Nov-18 02:54 PM] TonyL#3577
```./komodo-cli -ac_name=SPLTEST2 dicestatus TONY b0865b83755daa54e3c1d47163691677ec60d058183f3334b7abcd3bc3f7d09d d5c95ead928b5ea0e8e5853e67d083d3a8cc49efe5b1136cea131e4939141a6e
cc_verify error C
cc_verify error C
rebroadcast.L and clear [0] and broadcast entropyused.4017b5d87f3275d89a743ddb55b263d06e85edab09ddeab9890b7fffba3dd522 bettxid.d5c95ead928b5ea0e8e5853e67d083d3a8cc49efe5b1136cea131e4939141a6e -> f2dad8098416fe74cabdac99d2af83c4394f6263628eb1cf76881890084c03e3
error: couldn't connect to server: EOF reached (code 1)
(make sure server is running and you are connecting to the correct RPC port)``` repeated

[28-Nov-18 02:55 PM] jl777c#5810
backtrace plz

[28-Nov-18 02:57 PM] jl777c#5810
i changed so dicestatus as non-dealer needs to specify bettxid

[28-Nov-18 02:57 PM] jl777c#5810
but it should have printed an error

[28-Nov-18 02:58 PM] TonyL#3577
@jl777c https://paste.ubuntu.com/p/Rsg36hfw3f/

[28-Nov-18 03:07 PM] jl777c#5810
pushed fix

[28-Nov-18 03:22 PM] KNOX#9338
merged FSM branch

[28-Nov-18 03:35 PM] siu - Chainmakers#3920
recompiling

[28-Nov-18 03:45 PM] SHossain#0007
`dicebet` tx version 4 as well

[28-Nov-18 03:45 PM] SHossain#0007
i could bet on your plan, couldn't do on mine

[28-Nov-18 03:53 PM] SHossain#0007
with 19 entropy tx my dealer node still seems to be broke
```
pendingbets.0 numentropy tx 19: 32480.40000000
```

[28-Nov-18 03:56 PM] jl777c#5810
yes, 100 is the minimum

